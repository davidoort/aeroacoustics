% CoaxialModel determines the new states of the coaxial helicopter
% with the developed BEM for the coaxial helicopter
% Works only in combination with PIDcoaxial.mdl

% Made by John Campfens (1296434)
% Delft University of Technology, February 2008

% Based on graduation project of Jasper van der Vorst (1998)

function f = CoaxialModel(in)

% Define globals
global deg2rad h
global Cla c R I_beta twist sigma Cd Kbeta
global F0 K_fus
global Vol_fus alpha0_hs x_hs S_hs Cla_hs beta0_fin x_fin z_fin S_fin
global Cla_fin CDS k n W M_tr Omega
global zhu yhu xhu m Iyy Ixx Jxz Izz Nb tau_lambda theta_tw
global xhl yhl zhl Vtip

states=in(1:14)
controls=in(15:18)

% Individual states from state-vector
u	       = states(1);	 % Airspeed along x-axis          [m/s]
v	       = states(2);	 % Airspeed along y-axis          [m/s]
w	       = states(3);	 % Airspeed along z-axis          [m/s]
p	       = states(4);	 % Roll rate                      [rad/s]
q	       = states(5);	 % Pitch rate                     [rad/s]
r	       = states(6);	 % Yaw rate                       [rad/s]
psi	       = states(7);	 % Helicopter yaw angle           [rad]
theta	   = states(8);  % Helicopter pitch angle         [rad]
phi	       = states(9);  % Helicopter roll angle          [rad]
x	       = states(10); % Position along Earth x-axis    [m]
y	       = states(11); % Position along Earth y-axis    [m]
z	       = states(12); % Position along Earth z-axis    [m]
L0_u      = states(13);  % Induced velocity of the isolated upper rotor [-]
L0_l       = states(14); % Induced velocity of the isolated lower rotor [-]

% Control angles [rad]
% Upper rotor collective
theta_0u = controls(1);
% Lower rotor collective
theta_0l = controls(2);
% Longitudinal cyclic
theta_1s = controls(3);
% Lateral cyclic
theta_1c = controls(4);

% Determining non-dimensional velocities
mu_x = u/Vtip; 	% Normalised velocity along x-axis [-]
mu_y = v/Vtip;  % Normalised velocity along y-axis [-]
mu_z = w/Vtip;  % Normalised velocity along z-axis [-]


% Refreshing other variables
rhoh = 1.225;                      % Density at specific alt [kg/m^3]
gamma = rhoh*Cla*c*R^2/I_beta;      % Blade Lock number       [-]
alpha_cp = -atan2(w,u)+theta_1s;    % AOA of control plane      [rad]
V	     = sqrt(u^2+v^2+w^2);       % Total helicopter velocity [m/s]
mu=V/(Vtip);

twist=theta_tw;

% Determining flapping characteristics
wb=sqrt(Kbeta/I_beta)/Omega;        % Non-dimensional blade flapping natural frequency of non-rotating blade
vb=sqrt(1+wb^2);                    % Non-dimensional rotating flapping frequency

% Determining dimensionless factor
dimless = rhoh*Vtip^2*pi*R^2; 


%-----------------Calculations of upper rotor---------------------%

Lc_u=0;                         % Climbing velocity
Li_u=L0_u;                      % Total induced velocity

% Flapping coefficients
a0_u=(gamma/8*(1+mu_x^2-2*r/Omega)*theta_0u-gamma/6*mu_y*theta_1c-gamma/6*mu_x*theta_1s+...
    gamma/8*(4/5-8/5*r/Omega+2/3*mu_x^2)*theta_tw-gamma/6*(-mu_z+Li_u)+gamma/12*mu_x*p/Omega+...
    gamma/12*mu_y*q/Omega)/(vb^2-2*r/Omega);
a1_u=(gamma/6*mu_y*a0_u+gamma/3*mu_x*theta_0u-gamma/8*mu_x*mu_y*theta_1c-...
    gamma/8*(1-2*r/Omega+3/2*mu_x^2)*theta_1s+gamma/4*mu_x*theta_tw-gamma/4*mu_x*(-mu_z+Li_u)+...
    gamma/8*p/Omega-2*q/Omega)/(1-r/Omega-mu_x^2/2+mu_y^2/2);
b1_u=(-gamma/6*mu_x*a0_u+gamma/3*mu_y*theta_0u-gamma/8*(1-2*r/Omega+mu_x^2/2)*...
    theta_1c-gamma/8*mu_x*mu_y*theta_1s+gamma/4*mu_y*theta_tw-gamma/8*mu_y*(-mu_z+Li_u)+2*p/Omega+...
    gamma/8*q/Omega)/(-1+r/Omega-mu_x^2/2+mu_y^2/2);

% Determining rotor forces upper rotor with BEM
Tu=(1/2)*Nb*(-.3926990818*rhoh*c*Cla*(-2.*r^2*twist-2.*Omega^2*twist-4.*Omega*twist*r)*R^3-.5235987757*rhoh*c*Cla*(-2.*r^2*theta_0u*R-4.*Omega*theta_0u*R*r-2.*Omega^2*theta_0u*R)*R^2-.7853981635*rhoh*c*Cla*(-2.*r*R*w+2.*r*Omega*R^2*Lc_u-1.*v*R*q+a1_u*u*R-2.*Omega*R*w+2.*v*theta_1c*R*r+2.*Omega^2*R^2*Lc_u-1.*p*u*R-1.*v^2*twist-1.*twist*u^2-1.*v*R*b1_u+2.*r*Omega*R^2*Li_u+2.*Omega^2*R^2*Li_u+2.*v*theta_1c*R*Omega-1.*v*b1_u*Omega*R-1.*v*b1_u*r*R-1.*Omega*R*u*a1_u+2.*theta_1s*u*r*R-1.*r*R*u*a1_u+2.*theta_1s*u*Omega*R)*R-1.570796327*rhoh*c*Cla*(-1.*theta_0u*u^2*R-1.*v^2*theta_0u*R+2.*u*R*v*a0_u))/pi;

Hu=(1/2)*Nb*(0.9817477042e-1*c*rhoh*(4.*Cla*Omega^2*twist*a1_u+8.*Cla*Omega*twist*r*a1_u+4.*Cla*Omega*twist*a1_u-4.*Cla*twist*r*p-4.*Cla*Omega*twist*p+4.*Cla*r^2*twist*a1_u+4.*Cla*twist*r*a1_u)*R^3+.1308996939*c*rhoh*(8.*Cla*Omega*theta_1c*r*a0_u*R-4.*Cla*Omega*b1_u*a0_u*R-4.*Cla*twist*Omega*v*a0_u+4.*Cla*r^2*theta_1c*a0_u*R+4.*Cla*theta_0u*r*a1_u*R+4.*Cla*r^2*theta_0u*a1_u*R+4.*Cla*Omega^2*theta_0u*a1_u*R-4.*Cla*theta_0u*r*p*R-4.*Cla*r*q*a0_u*R+4.*Cla*Omega^2*theta_1c*a0_u*R-4.*Cla*theta_0u*Omega*p*R+8.*Cla*theta_0u*Omega*r*a1_u*R-4.*Cla*Omega*q*a0_u*R+4.*Cla*theta_0u*Omega*a1_u*R-4.*Cla*r*b1_u*a0_u*R-4.*Cla*v*twist*r*a0_u)*R^2+.1963495408*c*rhoh*(Cla*u*theta_1c*q*R+Cla*Omega*u*b1_u^2*R-1.*Cla*theta_1c*Omega*u*b1_u*R-5.*Cla*v*theta_1c*Omega*a1_u*R-2.*Cla*twist*u*v*b1_u-1.*Cla*u*b1_u*q*R+4.*Cla*r*w*a1_u*R+4.*Cla*twist*u*Omega*Lc_u*R+Cla*r*u*b1_u^2*R-8.*Cla*R^2*a1_u*Omega*Li_u+4.*Cla*r*u*a0_u^2*R-4.*Cla*theta_0u*v*Omega*a0_u*R+3.*Cla*u*theta_1s*p*R+Cla*v*theta_1s*b1_u*R+Cla*a1_u^2*u*R+2.*Cla*twist*v^2*a1_u-1.*Cla*u*b1_u^2*R-4.*Cla*twist*u*w+8.*Cla*a1_u*w*R+8.*Cd*u*r*R-8.*Cla*p*w*R+8.*Cd*Omega*u*R-4.*Cla*theta_0u*v*r*a0_u*R+Cla*v*theta_1s*r*b1_u*R+4.*Cla*theta_1s*r*w*R+6.*Cla*a1_u*v*b1_u*R+Cla*v*q*a1_u*R-3.*Cla*u*theta_1s*a1_u*R+3.*Cla*Omega*u*a1_u^2*R-4.*Cla*R^2*theta_1s*Omega^2*Lc_u+4.*Cla*Omega*w*a1_u*R-1.*Cla*u*p*a1_u*R+4.*Cla*Omega*u*a0_u^2*R-4.*Cla*R^2*Omega^2*Lc_u*a1_u-4.*Cla*R^2*r*Omega*Li_u*a1_u-1.*Cla*theta_1s*r*u*a1_u*R+3.*Cla*r*u*a1_u^2*R-5.*Cla*v*theta_1c*r*a1_u*R-5.*Cla*v*p*b1_u*R-1.*Cla*v*theta_1c*a1_u*R+Cla*u*theta_1c*b1_u*R-1.*Cla*theta_1c*r*u*b1_u*R+4.*Cla*twist*u*Omega*Li_u*R+Cla*v*theta_1c*p*R+2.*Cla*r*v*b1_u*a1_u*R+8.*Cla*R^2*p*Omega*Li_u-4.*Cla*R^2*Omega^2*Li_u*a1_u-4.*Cla*R^2*theta_1s*r*Omega*Lc_u-8.*Cla*R^2*a1_u*Omega*Lc_u-4.*Cla*R^2*theta_1s*Omega^2*Li_u+2.*Cla*Omega*v*b1_u*a1_u*R-4.*Cla*R^2*theta_1s*r*Omega*Li_u+8.*Cla*R^2*p*Omega*Lc_u+Cla*v*theta_1s*q*R-1.*Cla*u*theta_1s*Omega*a1_u*R+4.*Cla*theta_1s*Omega*w*R-4.*Cla*R^2*r*Omega*Lc_u*a1_u+Cla*theta_1s*Omega*v*b1_u*R)*R+.3926990817*c*rhoh*(4.*Cla*R^2*theta_0u*u*Omega*Lc_u+2.*Cla*v^2*theta_0u*a1_u*R-4.*Cla*theta_0u*u*w*R-4.*Cla*R^2*v*Omega*Li_u*a0_u-4.*Cla*u*v*a1_u*a0_u*R+2.*Cla*v^2*theta_1c*a0_u*R-2.*Cla*u*theta_1s*v*a0_u*R+4.*Cla*R^2*theta_0u*u*Omega*Li_u+4.*Cla*v*a0_u*w*R-4.*Cla*R^2*v*a0_u*Omega*Lc_u+4.*Cla*v^2*a0_u*b1_u*R-2.*Cla*theta_0u*u*v*b1_u*R))/pi;

Su=-(1/2)*Nb*(-0.9817477042e-1*c*rhoh*(4.*Cla*twist*Omega*q+4.*Cla*twist*r*q+8.*Cla*Omega*twist*r*b1_u+4.*Cla*r^2*twist*b1_u+4.*Cla*twist*Omega*b1_u+4.*Cla*Omega^2*twist*b1_u+4.*Cla*twist*r*b1_u)*R^3-.1308996939*c*rhoh*(4.*Cla*r^2*theta_1s*a0_u*R+4.*Cla*Omega^2*theta_1s*a0_u*R-4.*Cla*r*p*a0_u*R+8.*Cla*Omega*theta_0u*r*b1_u*R+8.*Cla*Omega*theta_1s*r*a0_u*R+4.*Cla*Omega^2*theta_0u*b1_u*R+4.*Cla*theta_0u*r*q*R-12.*Cla*twist*r*u*a0_u-4.*Cla*Omega*p*a0_u*R+4.*Cla*theta_0u*Omega*q*R+4.*Cla*r*a1_u*a0_u*R-12.*Cla*twist*Omega*u*a0_u+4.*Cla*Omega*a1_u*a0_u*R+4.*Cla*theta_0u*r*b1_u*R+4.*Cla*theta_0u*Omega*b1_u*R+4.*Cla*r^2*theta_0u*b1_u*R)*R^2-.1963495408*c*rhoh*(8.*Cla*q*w*R-3.*Cla*v*a1_u^2*R+3.*Cla*v*b1_u^2*R+4.*Cla*twist*v*w-8.*Cd*Omega*v*R-8.*Cd*v*r*R+4.*Cla*twist*u^2*b1_u+2.*Cla*v^2*twist*b1_u+4.*R^2*Cla*theta_1c*r*Omega*Li_u+3.*Cla*Omega*v*b1_u^2*R+4.*Cla*r*v*a0_u^2*R-8.*R^2*Cla*b1_u*Omega*Lc_u+4.*R^2*Cla*theta_1c*r*Omega*Lc_u-4.*Cla*R^2*r*Omega*Li_u*b1_u-4.*Cla*R^2*r*Omega*Lc_u*b1_u-4.*Cla*twist*v*Omega*Li_u*R+3.*Cla*v*p*a1_u*R-1.*Cla*theta_1s*u*b1_u*R+8.*Cla*b1_u*w*R-7.*Cla*theta_1s*r*u*b1_u*R-5.*Cla*theta_1c*r*u*a1_u*R-7.*Cla*theta_1s*Omega*u*b1_u*R+4.*Cla*Omega*w*b1_u*R+Cla*theta_1c*u*a1_u*R-4.*Cla*R^2*Omega^2*Li_u*b1_u+4.*Cla*Omega*v*a0_u^2*R-4.*Cla*R^2*Omega^2*Lc_u*b1_u+6.*Cla*twist*v*u*a1_u+2.*Cla*b1_u*u*a1_u*R+2.*Cla*Omega*u*a1_u*b1_u*R+5.*Cla*u*b1_u*p*R+3.*Cla*v*q*b1_u*R-4.*Cla*twist*v*Omega*Lc_u*R-12.*Cla*theta_0u*r*u*a0_u*R+Cla*r*v*a1_u^2*R+3.*Cla*r*v*b1_u^2*R-1.*Cla*theta_1s*u*q*R-3.*Cla*theta_1c*v*q*R+4.*Cla*r*w*b1_u*R-3.*Cla*v*theta_1s*Omega*a1_u*R-3.*Cla*v*theta_1s*r*a1_u*R-8.*R^2*Cla*q*Omega*Lc_u-3.*Cla*v*theta_1c*Omega*b1_u*R+4.*R^2*Cla*theta_1c*Omega^2*Lc_u-1.*Cla*theta_1c*u*p*R+4.*R^2*Cla*theta_1c*Omega^2*Li_u-8.*R^2*Cla*q*Omega*Li_u-8.*R^2*Cla*b1_u*Omega*Li_u+Cla*theta_1s*v*a1_u*R-12.*Cla*theta_0u*Omega*u*a0_u*R-4.*Cla*theta_1c*Omega*w*R-3.*Cla*v*theta_1c*r*b1_u*R+2.*Cla*r*u*a1_u*b1_u*R-1.*Cla*theta_1s*v*p*R+Cla*Omega*v*a1_u^2*R-3.*Cla*theta_1c*v*b1_u*R-4.*Cla*theta_1c*r*w*R-5.*Cla*theta_1c*Omega*u*a1_u*R+7.*Cla*q*u*a1_u*R)*R-.3926990817*c*rhoh*(4.*Cla*theta_0u*v*w*R+2.*Cla*v^2*theta_0u*b1_u*R+6.*Cla*theta_1c*u*v*a0_u*R+12.*R^2*Cla*u*a0_u*Omega*Li_u-4.*R^2*Cla*theta_0u*v*Omega*Li_u-12.*Cla*u*a0_u*w*R-12.*Cla*u*v*b1_u*a0_u*R+2.*Cla*v^2*theta_1s*a0_u*R-8.*Cla*u^2*a1_u*a0_u*R+4.*Cla*theta_0u*u^2*b1_u*R-4.*Cla*v^2*a0_u*a1_u*R+12.*R^2*Cla*u*a0_u*Omega*Lc_u-4.*R^2*Cla*theta_0u*v*Omega*Lc_u+6.*Cla*theta_0u*u*v*a1_u*R+4.*Cla*u^2*theta_1s*a0_u*R))/pi;

Qu=(1/2)*Nb*(-0.9817477042e-1*rhoh*c*(-4.*Cla*theta_1c*r*q*R+4.*Cla*theta_1s*r*a1_u*R-8.*Cla*twist*Omega^2*R*Li_u-8.*Cla*twist*Omega^2*R*Lc_u-8.*Cla*twist*r*Omega*R*Li_u-8.*Cla*twist*r*Omega*R*Lc_u-4.*Cla*theta_1c*Omega*b1_u*R-4.*Cla*theta_1c*r*b1_u*R+4.*Cla*v*b1_u*twist*Omega-4.*Cla*theta_1s*r*p*R-4.*Cla*theta_1s*Omega*p*R+4.*Cla*twist*r*u*a1_u+4.*Cla*p^2*R+4.*Cla*b1_u^2*R+4.*Cla*q^2*R-8.*Cd*R*Omega^2-8.*Cd*R*r^2+4.*Cla*a1_u^2*R+4.*Cla*twist*Omega*u*a1_u+4.*Cla*theta_1s*Omega*a1_u*R+8.*Cla*twist*Omega*w+8.*Cla*twist*r*w-8.*Cla*a1_u*p*R-16.*Cd*R*Omega*r+4.*Cla*v*b1_u*twist*r-4.*Cla*theta_1c*Omega*q*R+4.*Cla*twist*u*p+4.*Cla*twist*v*q+8.*Cla*b1_u*q*R+4.*Cla*twist*v*b1_u-4.*Cla*twist*u*a1_u)*R^3-.1308996939*rhoh*c*(-8.*Cla*theta_0u*R^2*r*Omega*Li_u-8.*Cla*theta_0u*R^2*r*Omega*Lc_u-8.*Cla*q*u*a0_u*R+8.*Cla*theta_0u*R*Omega*w+4.*Cla*theta_1c*Omega*u*a0_u*R+4.*Cla*theta_0u*r*u*a1_u*R+4.*Cla*v*b1_u*theta_0u*Omega*R+4.*Cla*v*a0_u*theta_1s*r*R-8.*Cla*theta_0u*R^2*Omega^2*Lc_u+4.*Cla*theta_0u*v*q*R+4.*Cla*v*b1_u*theta_0u*r*R+4.*Cla*theta_1c*r*u*a0_u*R+8.*Cla*theta_0u*R*r*w-4.*Cla*theta_0u*u*a1_u*R-8.*Cla*b1_u*u*a0_u*R+4.*Cla*theta_0u*u*p*R-8.*Cla*theta_0u*R^2*Omega^2*Li_u+4.*Cla*theta_0u*v*b1_u*R-8.*Cla*twist*v*u*a0_u+4.*Cla*v*a0_u*theta_1s*Omega*R+4.*Cla*theta_0u*Omega*u*a1_u*R-8.*Cla*p*v*a0_u*R+8.*Cla*a1_u*v*a0_u*R)*R^2-.1963495408*rhoh*c*(3.*Cla*u^2*a1_u^2*R-1.*Cla*u^2*b1_u*theta_1c*R-16.*Cla*R^2*w*Omega*Li_u+4.*R^2*Cla*theta_1s*u*Omega*Li_u-1.*Cla*u^2*a1_u*theta_1s*R-8.*R^2*Cla*u*a1_u*Omega*Li_u-8.*R^2*Cla*u*a1_u*Omega*Lc_u-1.*Cla*theta_1c*v^2*b1_u*R-4.*Cla*theta_1c*u*v*a1_u*R-4.*Cla*theta_1s*u*w*R+8.*Cla*R*w^2-4.*Cd*v^2*R+8.*Cla*Omega^2*R^3*Li_u^2+4.*R^2*Cla*theta_1s*u*Omega*Lc_u+4.*R^2*Cla*theta_1c*v*Omega*Lc_u+8.*Cla*u*a1_u*w*R-16.*Cla*R^2*w*Omega*Lc_u+16.*Cla*Omega^2*R^3*Li_u*Lc_u-4.*Cla*theta_1s*v*u*b1_u*R+8.*Cla*v*w*b1_u*R+8.*Cla*Omega^2*R^3*Lc_u^2-4.*Cd*u^2*R-8.*Cla*theta_0u*v*u*a0_u*R+4.*Cla*u*v*b1_u*a1_u*R+4.*Cla*u^2*a0_u^2*R-4.*Cla*theta_1c*v*w*R+4.*Cla*v^2*a0_u^2*R+3.*Cla*v^2*b1_u^2*R-8.*Cla*R^2*v*Omega*Lc_u*b1_u-1.*Cla*v^2*theta_1s*a1_u*R+4.*R^2*Cla*theta_1c*v*Omega*Li_u+Cla*u^2*b1_u^2*R+Cla*v^2*a1_u^2*R-8.*R^2*Cla*v*b1_u*Omega*Li_u)*R)/pi;

% Determining non-dimensional coefficients upper rotor
CTu=Tu/(dimless);
CHu=Hu/dimless;
CSu=Su/dimless;
CQu=Qu/(R*dimless);

% Determining thrust coefficients
Ct_el_up = CTu;                                                                     % Blade element theory
Ct_gl_up = 2*Li_u*sqrt((mu*cos(alpha_cp-a1_u))^2+(mu*sin(alpha_cp-a1_u)+Li_u)^2);   % Glauert theory

% Summing rotor forces and moments
Xu=Tu*sin(theta_1s)-Hu*cos(theta_1s);
Yu=Tu*sin(theta_1c)-Su*cos(theta_1c);
Zu=-Tu*cos(theta_1s)*cos(theta_1c)-Hu*sin(theta_1s)+Su*sin(theta_1c);

Lu = Yu*zhu-Zu*yhu;
Mu = -Xu*zhu-Zu*xhu;
Nu = Qu;


%-----------------Calculations of lower rotor---------------------%

% Determining wake skew angle of upper rotor wake
chi=atan(mu_x/(-mu_z+Li_u));

% Determining wake contraction of upper rotor wake following Landgrebe's
% generalized wake model
A=0.78;                                             % Wake coefficient
h_nd=0.189;                                         % Non dimensional separation distance
k1=((abs(CTu)/(Nb*c/(pi*R)))+0.001*theta_tw)*0.25;  % Landgrebe constant
k2=(1.41+0.0141*theta_tw)*sqrt(abs(CTu)/2);         % Landgrebe constant

psi_w=(2*pi)/Nb;                                    % Wake age
H_first=k1*psi_w;                                   % First separation distance
psi_wn=(h_nd-H_first+k2*2*pi/Nb)/k2;                % Determining new wake age

wc=A+(1-A)*exp(-(0.145+27*abs(CTu))*psi_wn);        % Wake contraction

j=1./wc;                                            % Inverse wake contraction for the attenuation coefficient


%-------------- Determining forces on section 1 (positive x direction)------------
% Determining attenuation coefficient for section 1

ds=R/20;                    % Stepsize of radius
dpsi_b=0.1*pi;              % Stepsize of azimuth angle

CattM=[];                   % Making attenuation coefficient table
psi_b=0.6*pi;               % Startvalue of azimuth angle for section 1

% Determining attenuation coefficient table for section 1 (with numerical
% integration)
while psi_b+dpsi_b<=1.5*pi
Catt=[];

for s=ds:ds:(R*j)
    mm=tan(chi);
    z0=h_nd;
    r0=(s.*j/R);
    
    dV=@(x)0.5.*(1+r0.*cos(-psi_b+x)-mm.*cos(x).*sqrt(1+r0.^2+z0.^2.+2.*r0.*...
    cos(-psi_b+x))./sqrt(1.+mm.^2))./(pi.*sqrt(1+r0.^2+z0.^2+2.*r0.*...
    cos(-psi_b+x)).*(sqrt(1+r0.^2+z0.^2+2.*r0.*cos(-psi_b+x))-(z0+mm.*...
    r0.*cos(psi_b)+mm.*cos(x))./sqrt(1+mm.^2)));
    
    Catt_t=quad(dV,0,2*pi);
    Catt=[Catt; Catt_t];
end
CattM=[CattM Catt];

psi_b=psi_b+dpsi_b;
 
end

% Determining properties of attenuation coefficient table of section 1
g=size(CattM);
length=g(1);
width=g(2);
i=round(g(2)/2);

% Determining attenuation coefficients of inner and outer part of section 1
if chi<=atan((R*wc)/(R*h_nd))                   % Situation 1.1
     [trash,cp]=max(abs(diff(CattM(:,i))));     % Determining checkpoint (as row number)
     Catt_in=mean(CattM(1:cp,i));               % Attenuation coefficient for inner part of sit. 1.1
     Catt_out=mean(CattM(cp+1:end,i));          % Attenuation coefficient for outer part of sit. 1.1

else                                            % Situation 1.2    
    cp=0;                                       % Determining radial (as row number) 
    Catt_out=mean(CattM(1:end,i));              % Attenuation coefficient for outer part of sit. 1.2
    Catt_in=0;                                  % Attenuation coefficient for inner part of sit. 1.2
end

% Converting row number checkpoint to radial checkpoint in order to use this radial checkpoint 
% in the BEM as starting/ending values for the different integrals
cr=cp/g(1);

% Determining total induced velocities of section 1
Li_l_in=L0_l+Catt_in*Li_u;      % Inside upper rotor wake
Li_l_out=L0_l+Catt_out*Li_u;    % Outside upper rotor wake    
Lc_l=0;                         % Climbing velocity    

% Flapping coefficients inside upper rotor wake of section 1
a0_l_in=(gamma/8*(1+mu_x^2-2*r/Omega)*theta_0l-gamma/6*mu_y*theta_1c-gamma/6*mu_x*theta_1s+...
    gamma/8*(4/5-8/5*r/Omega+2/3*mu_x^2)*theta_tw-gamma/6*(-mu_z+Li_l_in)+gamma/12*mu_x*p/Omega+...
    gamma/12*mu_y*q/Omega)/(vb^2-2*r/Omega);
a1_l_in=(gamma/6*mu_y*a0_l_in+gamma/3*mu_x*theta_0l-gamma/8*mu_x*mu_y*theta_1c-...
    gamma/8*(1-2*r/Omega+3/2*mu_x^2)*theta_1s+gamma/4*mu_x*theta_tw-gamma/4*mu_x*(-mu_z+Li_l_in)+...
    gamma/8*p/Omega-2*q/Omega)/(1-r/Omega-mu_x^2/2+mu_y^2/2);
b1_l_in=(-gamma/6*mu_x*a0_l_in+gamma/3*mu_y*theta_0l-gamma/8*(1-2*r/Omega+mu_x^2/2)*...
    theta_1c-gamma/8*mu_x*mu_y*theta_1s+gamma/4*mu_y*theta_tw-gamma/8*mu_y*(-mu_z+Li_l_in)+2*p/Omega+...
    gamma/8*q/Omega)/(-1+r/Omega-mu_x^2/2+mu_y^2/2);

% Flapping coefficients outside upper rotor wake of section 1
a0_l_out=(gamma/8*(1+mu_x^2-2*r/Omega)*theta_0l-gamma/6*mu_y*theta_1c-gamma/6*mu_x*theta_1s+...
    gamma/8*(4/5-8/5*r/Omega+2/3*mu_x^2)*theta_tw-gamma/6*(-mu_z+Li_l_out)+gamma/12*mu_x*p/Omega+...
    gamma/12*mu_y*q/Omega)/(vb^2-2*r/Omega);
a1_l_out=(gamma/6*mu_y*a0_l_out+gamma/3*mu_x*theta_0l-gamma/8*mu_x*mu_y*theta_1c-...
    gamma/8*(1-2*r/Omega+3/2*mu_x^2)*theta_1s+gamma/4*mu_x*theta_tw-gamma/4*mu_x*(-mu_z+Li_l_out)+...
    gamma/8*p/Omega-2*q/Omega)/(1-r/Omega-mu_x^2/2+mu_y^2/2);
b1_l_out=(-gamma/6*mu_x*a0_l_out+gamma/3*mu_y*theta_0l-gamma/8*(1-2*r/Omega+mu_x^2/2)*...
    theta_1c-gamma/8*mu_x*mu_y*theta_1s+gamma/4*mu_y*theta_tw-gamma/8*mu_y*(-mu_z+Li_l_out)+2*p/Omega+...
    gamma/8*q/Omega)/(-1+r/Omega-mu_x^2/2+mu_y^2/2);
ba_l_out=sqrt(a1_l_out^2+b1_l_out^2);

% Determining rotor forces of lower rotor section 1 with BEM (determined by Maple)
% Inside upper rotor wake
Tl_in=0.2083333333e-1*Cla*rhoh*c*(18.84955592*Omega^2*twist+18.84955592*r^2*twist+37.69911184*Omega*twist*r)*R^3*cr^4+0.2777777778e-1*Cla*rhoh*c*(-12.*theta_1c*r^2*R-12.*theta_1c*Omega^2*R-12.*q*Omega*R-12.*q*r*R-24.*twist*v*Omega-12.*b1_l_in*r*R-24.*theta_1c*Omega*r*R+18.84955592*r^2*theta_0l*R+37.69911184*Omega*theta_0l*r*R-24.*twist*v*r+18.84955592*Omega^2*theta_0l*R-12.*b1_l_in*Omega*R)*R^2*cr^3+0.4166666666e-1*Cla*rhoh*c*(-18.84955592*theta_1s*u*Omega*R-18.84955592*r*Omega*R^2*Li_l_in+9.424777961*twist*u^2+9.424777961*v^2*twist-18.84955592*Omega^2*R^2*Lc_l+9.424777961*v*R*b1_l_in+9.424777961*p*u*R+9.424777961*v*R*q-9.424777961*a1_l_in*u*R-18.84955592*Omega*R^2*Lc_l*r+18.84955592*w*Omega*R+9.424777961*v*b1_l_in*Omega*R+9.424777961*r*R*u*a1_l_in+9.424777961*v*b1_l_in*r*R-18.84955592*theta_1s*u*r*R+9.424777961*Omega*R*u*a1_l_in-18.84955592*Omega^2*R^2*Li_l_in+18.84955592*v*theta_1c*R*Omega-24.*theta_0l*v*r*R-24.*theta_0l*v*Omega*R+12.*u*a0_l_in*Omega*R+12.*u*a0_l_in*r*R+18.84955592*w*r*R+18.84955592*v*theta_1c*R*r)*R*cr^2+0.8333333333e-1*Cla*rhoh*c*(-4.*theta_1c*u^2*R-4.*v^2*b1_l_in*R-4.*u^2*b1_l_in*R+9.424777961*theta_0l*u^2*R-12.*u*a1_l_in*v*R-18.84955592*u*a0_l_in*v*R+8.*theta_1s*u*v*R+9.424777961*v^2*theta_0l*R-8.*theta_1c*v^2*R+12.*Omega*R^2*Lc_l*v+12.*Omega*R^2*Li_l_in*v-12.*w*v*R)*cr;
Hl_in=0.1041666667e-2*c*rhoh*(240.*Cla*r^2*twist*a0_l_in+188.4955592*Cla*r^2*twist*a1_l_in+188.4955592*Cla*twist*r*a1_l_in+188.4955592*Cla*Omega^2*twist*a1_l_in+376.9911184*Cla*Omega*twist*r*a1_l_in-188.4955592*Cla*twist*r*p+188.4955592*Cla*twist*Omega*a1_l_in-188.4955592*Cla*twist*Omega*p+240.*Cla*Omega^2*twist*a0_l_in+480.*Cla*Omega*twist*r*a0_l_in)*R^3*cr^4+0.1388888889e-2*c*rhoh*(160.*Cla*q*p*R-160.*Cla*a1_l_in*b1_l_in*R+160.*Cla*p*b1_l_in*R+80.*Cla*twist*u*b1_l_in+80.*Cla*twist*u*q+188.4955592*Cla*Omega^2*theta_0l*a1_l_in*R-320.*Cla*Omega*theta_1c*r*a1_l_in*R+80.*Cla*r^2*theta_1s*b1_l_in*R-188.4955592*Cla*theta_0l*r*p*R-80.*Cla*v*twist*a1_l_in-160.*Cla*q*a1_l_in*R-188.4955592*Cla*v*twist*r*a0_l_in+376.9911184*Cla*Omega*theta_0l*r*a1_l_in*R-188.4955592*Cla*Omega*b1_l_in*a0_l_in*R-188.4955592*Cla*r*q*a0_l_in*R-376.9911184*Cla*Omega*theta_1c*r*a0_l_in*R-188.4955592*Cla*r^2*theta_1c*a0_l_in*R-160.*Cla*r*q*a1_l_in*R+80.*Cla*theta_1c*r*p*R-188.4955592*Cla*r*b1_l_in*a0_l_in*R+240.*Cla*Omega^2*theta_0l*a0_l_in*R-188.4955592*Cla*theta_0l*Omega*p*R-80.*Cla*Omega*b1_l_in*a1_l_in*R-160.*Cla*r^2*theta_1c*a1_l_in*R-160.*Cla*Omega^2*theta_1c*a1_l_in*R+188.4955592*Cla*theta_0l*r*a1_l_in*R-80.*Cla*Omega*p*b1_l_in*R-80.*Cla*r*b1_l_in*a1_l_in*R-188.4955592*Cla*Omega^2*theta_1c*a0_l_in*R-188.4955592*Cla*Omega*q*a0_l_in*R-80.*Cla*Omega*theta_1s*q*R+188.4955592*Cla*theta_0l*Omega*a1_l_in*R-80.*Cla*r*p*b1_l_in*R-80.*Cla*twist*Omega*u*b1_l_in+188.4955592*Cla*r^2*theta_0l*a1_l_in*R+80.*Cla*Omega^2*theta_1s*b1_l_in*R-188.4955592*Cla*twist*Omega*v*a0_l_in+480.*Cla*theta_0l*Omega*r*a0_l_in*R+80.*Cla*Omega*theta_1c*p*R-80.*Cla*theta_1s*r*b1_l_in*R-80.*Cla*Omega*theta_1c*a1_l_in*R-80.*Cla*theta_1c*r*a1_l_in*R-240.*Cla*twist*r*v*a1_l_in+80.*Cla*v*twist*p+160.*Cla*Omega*theta_1s*r*b1_l_in*R-160.*Cla*Omega*q*a1_l_in*R-80.*Cla*theta_1s*r*q*R+240.*Cla*r^2*theta_0l*a0_l_in*R-80.*Cla*Omega*theta_1s*b1_l_in*R-80.*Cla*twist*r*u*b1_l_in-240.*Cla*v*twist*Omega*a1_l_in)*R^2*cr^3+0.2083333334e-2*c*rhoh*(-47.12388980*Cla*u*b1_l_in^2*R+80.*Cla*theta_0l*u*b1_l_in*R+80.*Cla*a1_l_in*u*a0_l_in*R-80.*Cla*v*theta_0l*a1_l_in*R+376.9911184*Cla*a1_l_in*w*R+47.12388980*Cla*r*u*b1_l_in^2*R-188.4955592*Cla*twist*u*w+94.24777961*Cla*r*v*a1_l_in*b1_l_in*R-188.4955592*Cla*R^2*Omega^2*Li_l_in*a1_l_in-188.4955592*Cla*v*theta_0l*Omega*a0_l_in*R+376.9911184*Cd*u*r*R+320.*Cla*Omega*u*a0_l_in*a1_l_in*R+47.12388980*Cla*Omega*u*b1_l_in^2*R+94.24777961*Cla*v^2*twist*a1_l_in+188.4955592*Cla*twist*u*Omega*Lc_l*R-47.12388980*Cla*u*q*b1_l_in*R-94.24777961*Cla*u*twist*v*b1_l_in+47.12388980*Cla*u*theta_1c*Omega*b1_l_in*R+240.*Cla*theta_1c*r*v*a0_l_in*R+376.9911184*Cd*Omega*u*R+235.6194490*Cla*theta_1c*Omega*v*a1_l_in*R+376.9911184*R^2*Cla*Omega*Li_l_in*p+47.12388980*Cla*u*a1_l_in^2*R-141.3716694*Cla*theta_1s*u*a1_l_in*R+188.4955592*Cla*w*r*a1_l_in*R-240.*Cla*R^2*Omega^2*Lc_l*a0_l_in+188.4955592*Cla*r*u*a0_l_in^2*R-188.4955592*Cla*R^2*Omega*Lc_l*r*a1_l_in+141.3716694*Cla*r*u*a1_l_in^2*R-80.*Cla*theta_1s*r*u*a0_l_in*R-47.12388980*Cla*u*theta_1s*r*a1_l_in*R+80.*Cla*v*theta_0l*p*R+47.12388980*Cla*theta_1s*v*q*R+240.*Cla*theta_1c*Omega*v*a0_l_in*R-188.4955592*Cla*R^2*r*Omega*Li_l_in*a1_l_in+47.12388980*Cla*v*theta_1s*Omega*b1_l_in*R-240.*Cla*R^2*Omega^2*Li_l_in*a0_l_in+188.4955592*Cla*Omega*u*a0_l_in^2*R-47.12388980*Cla*theta_1c*u*q*R-80.*Cla*theta_0l*r*u*b1_l_in*R+188.4955592*Cla*theta_1s*r*w*R-188.4955592*Cla*R^2*Omega^2*Lc_l*a1_l_in+188.4955592*Cla*w*Omega*a1_l_in*R-47.12388980*Cla*theta_1c*v*p*R-188.4955592*R^2*Cla*theta_1s*r*Omega*Li_l_in-80.*Cla*p*u*a0_l_in*R+240.*Cla*w*Omega*a0_l_in*R+188.4955592*Cla*twist*u*Omega*Li_l_in*R+47.12388980*Cla*v*theta_1s*r*b1_l_in*R+320.*Cla*r*u*a0_l_in*a1_l_in*R-188.4955592*R^2*Cla*theta_1s*Omega^2*Li_l_in+80.*Cla*theta_0l*u*q*R-47.12388980*Cla*u*theta_1s*Omega*a1_l_in*R+94.24777961*Cla*Omega*v*a1_l_in*b1_l_in*R+160.*Cla*Omega*v*b1_l_in*a0_l_in*R+160.*Cla*r*v*b1_l_in*a0_l_in*R+80.*Cla*twist*v^2*a0_l_in+47.12388980*Cla*theta_1s*v*b1_l_in*R+47.12388980*Cla*theta_1c*v*a1_l_in*R+47.12388980*Cla*u*theta_1c*r*b1_l_in*R-188.4955592*Cla*theta_0l*r*v*a0_l_in*R-376.9911184*R^2*Cla*Omega*Lc_l*a1_l_in-240.*Cla*R^2*Omega*Lc_l*r*a0_l_in+141.3716694*Cla*theta_1s*u*p*R+47.12388980*Cla*q*v*a1_l_in*R-188.4955592*R^2*Cla*theta_1s*r*Omega*Lc_l+282.7433388*Cla*v*b1_l_in*a1_l_in*R+235.6194490*Cla*v*theta_1c*r*a1_l_in*R+141.3716694*Cla*Omega*u*a1_l_in^2*R-376.9911184*Cla*p*w*R+376.9911184*R^2*Cla*Omega*Lc_l*p-188.4955592*R^2*Cla*theta_1s*Omega^2*Lc_l-376.9911184*R^2*Cla*Omega*Li_l_in*a1_l_in-240.*Cla*R^2*r*Omega*Li_l_in*a0_l_in+188.4955592*Cla*theta_1s*Omega*w*R-80.*Cla*theta_1s*u*Omega*a0_l_in*R-240.*Cla*v*theta_0l*Omega*a1_l_in*R-235.6194490*Cla*v*p*b1_l_in*R-47.12388980*Cla*u*p*a1_l_in*R+240.*Cla*w*r*a0_l_in*R-80.*Cla*theta_0l*Omega*u*b1_l_in*R-47.12388980*Cla*theta_1c*u*b1_l_in*R-240.*Cla*v*theta_0l*r*a1_l_in*R)*R*cr^2+0.4166666667e-2*c*rhoh*(188.4955592*R^2*Cla*theta_0l*u*Omega*Lc_l-188.4955592*Cla*theta_0l*u*w*R-188.4955592*Cla*R^2*v*Omega*Li_l_in*a0_l_in+188.4955592*R^2*Cla*theta_0l*u*Omega*Li_l_in-94.24777961*Cla*v^2*theta_1c*a0_l_in*R-80.*Cla*v*a0_l_in^2*u*R-80.*Cla*R^2*theta_1c*u*Omega*Li_l_in+80.*Cla*theta_1c*u*w*R-94.24777961*Cla*u*theta_1s*v*a0_l_in*R-16.*Cla*theta_1s*v^2*b1_l_in*R-80.*Cla*v*theta_1s*w*R+16.*Cla*u*b1_l_in^2*v*R+80.*Cla*R^2*theta_1s*v*Omega*Lc_l+80.*Cla*u*b1_l_in*w*R+94.24777961*Cla*v^2*theta_0l*a1_l_in*R+188.4955592*Cla*v*w*a0_l_in*R-94.24777961*Cla*u*theta_0l*v*b1_l_in*R-80.*Cla*R^2*Omega*Li_l_in*u*b1_l_in-160.*Cd*u*v*R-188.4955592*Cla*R^2*v*Omega*Lc_l*a0_l_in+188.4955592*Cla*v^2*b1_l_in*a0_l_in*R-96.*Cla*u*v*a1_l_in^2*R-96.*Cla*v^2*theta_1c*a1_l_in*R-16.*Cla*theta_1s*u*v*a1_l_in*R-188.4955592*Cla*u*v*a0_l_in*a1_l_in*R-80.*Cla*R^2*theta_1c*u*Omega*Lc_l+16.*Cla*theta_1c*u*v*b1_l_in*R+32.*Cla*v^2*a1_l_in*b1_l_in*R-80.*Cla*R^2*Omega*Lc_l*u*b1_l_in+80.*Cla*R^2*theta_1s*v*Omega*Li_l_in+80.*Cla*theta_0l*v^2*a0_l_in*R)*cr;
Sl_in=-0.1041666667e-2*c*rhoh*(188.4955592*Cla*twist*Omega*b1_l_in+376.9911184*Cla*Omega*twist*r*b1_l_in+188.4955592*Cla*twist*r*b1_l_in+188.4955592*Cla*r^2*twist*b1_l_in+188.4955592*Cla*twist*r*q+188.4955592*Cla*Omega^2*twist*b1_l_in+188.4955592*Cla*twist*Omega*q)*R^3*cr^4-0.1388888889e-2*c*rhoh*(240.*Cla*twist*Omega^2*R*Lc_l+240.*Cd*R*Omega^2+240.*Cd*R*r^2-160.*Cla*q^2*R-80.*Cla*a1_l_in^2*R-160.*Cla*b1_l_in^2*R-80.*Cla*p^2*R+188.4955592*Cla*Omega^2*theta_1s*a0_l_in*R-188.4955592*Cla*r*p*a0_l_in*R+80.*Cla*r^2*theta_1s*a1_l_in*R-80.*Cla*Omega*b1_l_in^2*R+80.*Cla*r*a1_l_in^2*R-80.*Cla*r*b1_l_in^2*R-160.*Cla*twist*v*q-320.*Cla*q*b1_l_in*R+80.*Cla*u*twist*a1_l_in-80.*Cla*u*twist*p+188.4955592*Cla*r^2*theta_1s*a0_l_in*R+188.4955592*Cla*r*a1_l_in*a0_l_in*R-188.4955592*Cla*Omega*p*a0_l_in*R+188.4955592*Cla*Omega^2*theta_0l*b1_l_in*R+188.4955592*Cla*r^2*theta_0l*b1_l_in*R-565.4866776*Cla*twist*Omega*u*a0_l_in-160.*Cla*theta_1c*r*q*R+188.4955592*Cla*theta_0l*Omega*b1_l_in*R+160.*Cla*theta_1s*Omega*r*a1_l_in*R+376.9911184*Cla*Omega*theta_0l*r*b1_l_in*R-240.*Cla*twist*v*r*b1_l_in-320.*Cla*u*twist*Omega*a1_l_in-320.*Cla*u*twist*r*a1_l_in+188.4955592*Cla*theta_0l*r*b1_l_in*R-160.*Cla*Omega*theta_1c*r*b1_l_in*R-80.*Cla*Omega*q*b1_l_in*R+188.4955592*Cla*theta_0l*Omega*q*R+240.*Cla*twist*Omega^2*R*Li_l_in-240.*Cla*twist*Omega*v*b1_l_in+376.9911184*Cla*Omega*theta_1s*r*a0_l_in*R-80.*Cla*Omega*p*a1_l_in*R-80.*Cla*r^2*theta_1c*b1_l_in*R-160.*Cla*Omega*theta_1c*b1_l_in*R-160.*Cla*theta_1c*r*b1_l_in*R-160.*Cla*Omega*theta_1c*q*R-80.*Cla*r*p*a1_l_in*R+188.4955592*Cla*theta_0l*r*q*R-80.*Cla*Omega^2*theta_1c*b1_l_in*R+80.*Cla*theta_1s*r*p*R+80.*Cla*Omega^2*theta_1s*a1_l_in*R-565.4866776*Cla*twist*r*u*a0_l_in+80.*Cla*theta_1s*Omega*p*R-80.*Cla*theta_1s*r*a1_l_in*R+240.*Cla*twist*r*Omega*R*Li_l_in+240.*Cla*twist*r*Omega*R*Lc_l+188.4955592*Cla*Omega*a1_l_in*a0_l_in*R-80.*Cla*r*q*b1_l_in*R-80.*Cla*theta_1s*Omega*a1_l_in*R+480.*Cd*R*Omega*r+160.*Cla*p*a1_l_in*R+80.*Cla*Omega*a1_l_in^2*R-240.*Cla*twist*r*w-240.*Cla*twist*Omega*w-160.*Cla*twist*v*b1_l_in)*R^2*cr^3-0.2083333334e-2*c*rhoh*(-240.*Cla*theta_0l*R*r*w-240.*Cla*theta_0l*R*Omega*w+320.*Cla*u*theta_1c*r*a0_l_in*R+141.3716694*Cla*theta_1c*v*b1_l_in*R-160.*Cla*theta_0l*v*q*R-376.9911184*R^2*Cla*Omega*Lc_l*b1_l_in+376.9911184*Cla*q*w*R-376.9911184*Cd*Omega*v*R-376.9911184*Cd*v*r*R+141.3716694*Cla*v*theta_1c*r*b1_l_in*R+188.4955592*Cla*Omega*v*a0_l_in^2*R-188.4955592*R^2*Cla*theta_1c*Omega^2*Lc_l+188.4955592*Cla*w*r*b1_l_in*R+188.4955592*Cla*w*Omega*b1_l_in*R+141.3716694*Cla*theta_1c*v*q*R+329.8672286*Cla*q*u*a1_l_in*R-329.8672286*Cla*theta_1s*r*u*b1_l_in*R+141.3716694*Cla*v*p*a1_l_in*R-188.4955592*Cla*twist*v*Omega*Lc_l*R+141.3716694*Cla*v*q*b1_l_in*R-565.4866776*Cla*theta_0l*r*u*a0_l_in*R+160.*Cla*Omega*v*a0_l_in*a1_l_in*R+400.*Cla*u*q*a0_l_in*R+47.12388980*Cla*Omega*v*a1_l_in^2*R-320.*Cla*u*theta_0l*Omega*a1_l_in*R+188.4955592*Cla*theta_1c*Omega*w*R+94.24777961*Cla*b1_l_in*u*a1_l_in*R+188.4955592*Cla*theta_1c*r*w*R+235.6194490*Cla*p*u*b1_l_in*R+400.*Cla*u*twist*v*a0_l_in-188.4955592*Cla*R^2*Omega^2*Li_l_in*b1_l_in-565.4866776*Cla*theta_0l*Omega*u*a0_l_in*R-240.*Cla*theta_0l*v*Omega*b1_l_in*R-80.*Cla*u*theta_0l*p*R+160.*Cla*r*v*a0_l_in*a1_l_in*R-188.4955592*Cla*R^2*Omega*Lc_l*r*b1_l_in+320.*Cla*u*theta_1c*Omega*a0_l_in*R+400.*Cla*u*b1_l_in*a0_l_in*R-376.9911184*R^2*Cla*Omega*Li_l_in*b1_l_in+282.7433388*Cla*twist*u*v*a1_l_in+240.*Cla*theta_0l*R^2*Omega^2*Li_l_in+240.*Cla*theta_0l*R^2*Omega^2*Lc_l-329.8672286*Cla*theta_1s*u*Omega*b1_l_in*R-188.4955592*Cla*R^2*r*Omega*Li_l_in*b1_l_in+235.6194490*Cla*theta_1c*r*u*a1_l_in*R+160.*Cla*r*u*a0_l_in*b1_l_in*R+240.*Cla*v*a0_l_in*p*R-240.*Cla*theta_1s*Omega*v*a0_l_in*R-376.9911184*R^2*Cla*q*Omega*Li_l_in+47.12388980*Cla*theta_1c*u*p*R-47.12388980*Cla*theta_1s*u*q*R+141.3716694*Cla*r*v*b1_l_in^2*R+141.3716694*Cla*v*theta_1c*Omega*b1_l_in*R-160.*Cla*theta_0l*v*b1_l_in*R+188.4955592*Cla*r*v*a0_l_in^2*R+80.*Cla*u*theta_0l*a1_l_in*R+160.*Cla*Omega*u*a0_l_in*b1_l_in*R-240.*Cla*v*a0_l_in*a1_l_in*R+47.12388980*Cla*v*theta_1s*a1_l_in*R-47.12388980*Cla*theta_1c*u*a1_l_in*R+141.3716694*Cla*Omega*v*b1_l_in^2*R-188.4955592*Cla*twist*v*Omega*Li_l_in*R+94.24777961*Cla*Omega*u*b1_l_in*a1_l_in*R+235.6194490*Cla*theta_1c*Omega*u*a1_l_in*R-188.4955592*R^2*Cla*theta_1c*r*Omega*Lc_l-47.12388980*Cla*theta_1s*u*b1_l_in*R-47.12388980*Cla*v*theta_1s*p*R-141.3716694*Cla*v*theta_1s*Omega*a1_l_in*R-141.3716694*Cla*v*theta_1s*r*a1_l_in*R+47.12388980*Cla*r*v*a1_l_in^2*R+94.24777961*Cla*r*u*b1_l_in*a1_l_in*R-188.4955592*R^2*Cla*theta_1c*r*Omega*Li_l_in-240.*Cla*theta_1s*r*v*a0_l_in*R-188.4955592*Cla*R^2*Omega^2*Lc_l*b1_l_in-240.*Cla*theta_0l*r*v*b1_l_in*R-188.4955592*R^2*Cla*theta_1c*Omega^2*Li_l_in+240.*Cla*theta_0l*R^2*r*Omega*Li_l_in+240.*Cla*theta_0l*R^2*r*Omega*Lc_l-376.9911184*R^2*Cla*q*Omega*Lc_l-320.*Cla*u*theta_0l*r*a1_l_in*R-141.3716694*Cla*v*a1_l_in^2*R+141.3716694*Cla*v*b1_l_in^2*R+188.4955592*Cla*u^2*twist*b1_l_in+94.24777961*Cla*v^2*twist*b1_l_in+188.4955592*Cla*twist*v*w+376.9911184*Cla*b1_l_in*w*R)*R*cr^2-0.4166666667e-2*c*rhoh*(-64.*Cla*v^2*theta_1c*b1_l_in*R-288.*Cla*v*u*b1_l_in*a1_l_in*R+176.*Cla*u*theta_1s*v*b1_l_in*R-224.*Cla*u*theta_1c*v*a1_l_in*R+94.24777961*Cla*v^2*theta_1s*a0_l_in*R+400.*Cla*u*theta_0l*v*a0_l_in*R+282.7433388*Cla*theta_0l*v*u*a1_l_in*R+480.*Cla*Omega*R^2*Li_l_in*w+480.*Cla*Omega*R^2*Lc_l*w-480.*Cla*Omega^2*R^3*Li_l_in*Lc_l+565.4866776*R^2*Cla*Omega*Lc_l*u*a0_l_in+565.4866776*R^2*Cla*Omega*Li_l_in*u*a0_l_in+160.*Cd*v^2*R+400.*Cla*R^2*u*Omega*Li_l_in*a1_l_in-160.*Cla*u^2*a1_l_in^2*R+80.*Cla*theta_1s*u^2*a1_l_in*R-282.7433388*Cla*theta_1c*v*u*a0_l_in*R-64.*Cla*v^2*a1_l_in^2*R-80.*Cla*theta_1c*u^2*b1_l_in*R+80.*Cd*u^2*R-565.4866776*Cla*v*u*b1_l_in*a0_l_in*R+188.4955592*Cla*theta_0l*v*w*R-240.*Cla*Omega^2*R^3*Li_l_in^2+400.*Cla*R^2*u*Omega*Lc_l*a1_l_in+240.*Cla*R^2*v*Omega*Lc_l*b1_l_in-240.*Cla*u^2*a0_l_in^2*R+80.*Cla*u*theta_1s*w*R-565.4866776*Cla*w*u*a0_l_in*R-240.*Cla*Omega^2*R^3*Lc_l^2+160.*Cla*R^2*theta_1c*v*Omega*Lc_l+240.*Cla*R^2*v*Omega*Li_l_in*b1_l_in-240.*Cla*R*w^2-376.9911184*Cla*u^2*a0_l_in*a1_l_in*R-80.*Cla*u^2*b1_l_in^2*R-80.*Cla*R^2*theta_1s*u*Omega*Li_l_in+94.24777961*Cla*v^2*theta_0l*b1_l_in*R-160.*Cla*v^2*a0_l_in^2*R-188.4955592*Cla*v^2*a1_l_in*a0_l_in*R-80.*Cla*R^2*theta_1s*u*Omega*Lc_l-96.*Cla*v^2*b1_l_in^2*R-160.*Cla*v*theta_1c*w*R-240.*Cla*v*b1_l_in*w*R-188.4955592*R^2*Cla*theta_0l*v*Omega*Lc_l-188.4955592*R^2*Cla*theta_0l*v*Omega*Li_l_in+64.*Cla*v^2*theta_1s*a1_l_in*R+188.4955592*Cla*u^2*theta_0l*b1_l_in*R+188.4955592*Cla*u^2*theta_1s*a0_l_in*R+160.*Cla*R^2*theta_1c*v*Omega*Li_l_in-400.*Cla*u*w*a1_l_in*R)*cr;
Ql_in=0.4166666666e-2*rhoh*c*(-48.*Cla*twist*r*q-48.*Cla*twist*Omega*b1_l_in-48.*Cla*twist*r*b1_l_in-48.*Cla*twist*Omega*q)*R^4*cr^5+0.5208333332e-2*rhoh*c*(-75.39822369*Cla*twist*Omega^2*R*Lc_l-75.39822369*Cd*R*Omega^2-75.39822369*Cd*R*r^2+37.69911184*Cla*q^2*R+37.69911184*Cla*a1_l_in^2*R+37.69911184*Cla*b1_l_in^2*R+37.69911184*Cla*p^2*R+37.69911184*Cla*twist*v*q+75.39822369*Cla*q*b1_l_in*R-37.69911184*Cla*u*twist*a1_l_in+37.69911184*Cla*u*twist*p+48.*Cla*twist*Omega*u*a0_l_in+37.69911184*Cla*theta_1c*r*q*R-48.*Cla*theta_0l*Omega*b1_l_in*R+37.69911184*Cla*twist*v*r*b1_l_in+37.69911184*Cla*u*twist*Omega*a1_l_in+37.69911184*Cla*u*twist*r*a1_l_in-48.*Cla*theta_0l*r*b1_l_in*R-48.*Cla*theta_0l*Omega*q*R-75.39822369*Cla*twist*Omega^2*R*Li_l_in+37.69911184*Cla*twist*Omega*v*b1_l_in+37.69911184*Cla*Omega*theta_1c*b1_l_in*R+37.69911184*Cla*theta_1c*r*b1_l_in*R+37.69911184*Cla*Omega*theta_1c*q*R-48.*Cla*theta_0l*r*q*R-37.69911184*Cla*theta_1s*r*p*R+48.*Cla*twist*r*u*a0_l_in-37.69911184*Cla*theta_1s*Omega*p*R+37.69911184*Cla*theta_1s*r*a1_l_in*R-75.39822369*Cla*twist*r*Omega*R*Li_l_in-75.39822369*Cla*twist*r*Omega*R*Lc_l+37.69911184*Cla*theta_1s*Omega*a1_l_in*R-150.7964474*Cd*R*Omega*r-75.39822369*Cla*p*a1_l_in*R+75.39822369*Cla*twist*r*w+75.39822369*Cla*twist*Omega*w+37.69911184*Cla*twist*v*b1_l_in)*R^3*cr^4+0.6944444443e-2*rhoh*c*(75.39822369*Cla*theta_0l*R*r*w+75.39822369*Cla*theta_0l*R*Omega*w-37.69911184*Cla*u*theta_1c*r*a0_l_in*R-32.*Cla*theta_1c*v*b1_l_in*R+37.69911184*Cla*theta_0l*v*q*R+96.*R^2*Cla*Omega*Lc_l*b1_l_in-96.*Cla*q*w*R+96.*Cd*Omega*v*R+96.*Cd*v*r*R-16.*Cla*v*theta_1c*r*b1_l_in*R+48.*R^2*Cla*theta_1c*Omega^2*Lc_l-32.*Cla*theta_1c*v*q*R-64.*Cla*q*u*a1_l_in*R+16.*Cla*theta_1s*r*u*b1_l_in*R-32.*Cla*v*p*a1_l_in*R+48.*Cla*twist*v*Omega*Lc_l*R-32.*Cla*v*q*b1_l_in*R+48.*Cla*theta_0l*r*u*a0_l_in*R-75.39822369*Cla*u*q*a0_l_in*R+37.69911184*Cla*u*theta_0l*Omega*a1_l_in*R-48.*Cla*theta_1c*Omega*w*R-32.*Cla*b1_l_in*u*a1_l_in*R-48.*Cla*theta_1c*r*w*R-32.*Cla*p*u*b1_l_in*R-75.39822369*Cla*u*twist*v*a0_l_in+48.*Cla*theta_0l*Omega*u*a0_l_in*R+37.69911184*Cla*theta_0l*v*Omega*b1_l_in*R+37.69911184*Cla*u*theta_0l*p*R-37.69911184*Cla*u*theta_1c*Omega*a0_l_in*R-75.39822369*Cla*u*b1_l_in*a0_l_in*R+96.*R^2*Cla*Omega*Li_l_in*b1_l_in-48.*Cla*twist*u*v*a1_l_in-75.39822369*Cla*theta_0l*R^2*Omega^2*Li_l_in-75.39822369*Cla*theta_0l*R^2*Omega^2*Lc_l+16.*Cla*theta_1s*u*Omega*b1_l_in*R-32.*Cla*theta_1c*r*u*a1_l_in*R-75.39822369*Cla*v*a0_l_in*p*R+37.69911184*Cla*theta_1s*Omega*v*a0_l_in*R+96.*R^2*Cla*q*Omega*Li_l_in-16.*Cla*theta_1c*u*p*R+16.*Cla*theta_1s*u*q*R-16.*Cla*v*theta_1c*Omega*b1_l_in*R+37.69911184*Cla*theta_0l*v*b1_l_in*R-37.69911184*Cla*u*theta_0l*a1_l_in*R+75.39822369*Cla*v*a0_l_in*a1_l_in*R-16.*Cla*v*theta_1s*a1_l_in*R+16.*Cla*theta_1c*u*a1_l_in*R+48.*Cla*twist*v*Omega*Li_l_in*R-32.*Cla*theta_1c*Omega*u*a1_l_in*R+48.*R^2*Cla*theta_1c*r*Omega*Lc_l+16.*Cla*theta_1s*u*b1_l_in*R+16.*Cla*v*theta_1s*p*R+16.*Cla*v*theta_1s*Omega*a1_l_in*R+16.*Cla*v*theta_1s*r*a1_l_in*R+48.*R^2*Cla*theta_1c*r*Omega*Li_l_in+37.69911184*Cla*theta_1s*r*v*a0_l_in*R+37.69911184*Cla*theta_0l*r*v*b1_l_in*R+48.*R^2*Cla*theta_1c*Omega^2*Li_l_in-75.39822369*Cla*theta_0l*R^2*r*Omega*Li_l_in-75.39822369*Cla*theta_0l*R^2*r*Omega*Lc_l+96.*R^2*Cla*q*Omega*Lc_l+37.69911184*Cla*u*theta_0l*r*a1_l_in*R+32.*Cla*v*a1_l_in^2*R-32.*Cla*v*b1_l_in^2*R-16.*Cla*u^2*twist*b1_l_in-16.*Cla*v^2*twist*b1_l_in-48.*Cla*twist*v*w-96.*Cla*b1_l_in*w*R)*R^2*cr^3+0.1041666666e-1*rhoh*c*(9.424777961*Cla*v^2*theta_1c*b1_l_in*R+37.69911184*Cla*v*u*b1_l_in*a1_l_in*R-37.69911184*Cla*u*theta_1s*v*b1_l_in*R+37.69911184*Cla*u*theta_1c*v*a1_l_in*R-16.*Cla*v^2*theta_1s*a0_l_in*R-75.39822369*Cla*u*theta_0l*v*a0_l_in*R-48.*Cla*theta_0l*v*u*a1_l_in*R-150.7964474*Cla*Omega*R^2*Li_l_in*w-150.7964474*Cla*Omega*R^2*Lc_l*w+150.7964474*Cla*Omega^2*R^3*Li_l_in*Lc_l-96.*R^2*Cla*Omega*Lc_l*u*a0_l_in-96.*R^2*Cla*Omega*Li_l_in*u*a0_l_in-37.69911184*Cd*v^2*R-75.39822369*Cla*R^2*u*Omega*Li_l_in*a1_l_in+28.27433388*Cla*u^2*a1_l_in^2*R-9.424777961*Cla*theta_1s*u^2*a1_l_in*R+48.*Cla*theta_1c*v*u*a0_l_in*R+9.424777961*Cla*v^2*a1_l_in^2*R+9.424777961*Cla*theta_1c*u^2*b1_l_in*R-37.69911184*Cd*u^2*R+64.*Cla*v*u*b1_l_in*a0_l_in*R-48.*Cla*theta_0l*v*w*R+75.39822369*Cla*Omega^2*R^3*Li_l_in^2-75.39822369*Cla*R^2*u*Omega*Lc_l*a1_l_in-75.39822369*Cla*R^2*v*Omega*Lc_l*b1_l_in+37.69911184*Cla*u^2*a0_l_in^2*R-37.69911184*Cla*u*theta_1s*w*R+96.*Cla*w*u*a0_l_in*R+75.39822369*Cla*Omega^2*R^3*Lc_l^2-37.69911184*Cla*R^2*theta_1c*v*Omega*Lc_l-75.39822369*Cla*R^2*v*Omega*Li_l_in*b1_l_in+75.39822369*Cla*R*w^2+64.*Cla*u^2*a0_l_in*a1_l_in*R+9.424777961*Cla*u^2*b1_l_in^2*R+37.69911184*Cla*R^2*theta_1s*u*Omega*Li_l_in-16.*Cla*v^2*theta_0l*b1_l_in*R+37.69911184*Cla*v^2*a0_l_in^2*R+32.*Cla*v^2*a1_l_in*a0_l_in*R+37.69911184*Cla*R^2*theta_1s*u*Omega*Lc_l+28.27433388*Cla*v^2*b1_l_in^2*R+37.69911184*Cla*v*theta_1c*w*R+75.39822369*Cla*v*b1_l_in*w*R+48.*R^2*Cla*theta_0l*v*Omega*Lc_l+48.*R^2*Cla*theta_0l*v*Omega*Li_l_in-9.424777961*Cla*v^2*theta_1s*a1_l_in*R-16.*Cla*u^2*theta_0l*b1_l_in*R-16.*Cla*u^2*theta_1s*a0_l_in*R-37.69911184*Cla*R^2*theta_1c*v*Omega*Li_l_in+75.39822369*Cla*u*w*a1_l_in*R)*R*cr^2;

% Outside upper rotor wake
Tl_out=0.2083333333e-1*rhoh*Cla*c*(18.84955592*Omega^2*twist+37.69911184*Omega*twist*r+18.84955592*r^2*twist)*(R^4-1.*cr^4*R^4)/R+0.2777777778e-1*rhoh*Cla*c*(18.84955592*r^2*theta_0l*R+18.84955592*Omega^2*theta_0l*R-24.*twist*v*r-12.*theta_1c*Omega^2*R-24.*theta_1c*Omega*r*R-12.*b1_l_out*Omega*R-12.*q*Omega*R-12.*q*r*R-12.*theta_1c*r^2*R-24.*twist*v*Omega-12.*b1_l_out*r*R+37.69911184*r*theta_0l*R*Omega)*(R^3-1.*cr^3*R^3)/R+0.4166666666e-1*rhoh*Cla*c*(18.84955592*v*theta_1c*R*r+9.424777961*p*u*R-24.*theta_0l*v*r*R+18.84955592*r*R*w-18.84955592*theta_1s*u*Omega*R-18.84955592*r*Omega*R^2*Lc_l+9.424777961*v*R*b1_l_out-18.84955592*Omega^2*R^2*Lc_l+18.84955592*Omega*R*w+9.424777961*v*b1_l_out*r*R-9.424777961*a1_l_out*u*R-18.84955592*r*Omega*R^2*Li_l_out-18.84955592*theta_1s*u*r*R+9.424777961*v^2*twist+12.*u*a0_l_out*Omega*R-24.*theta_0l*v*Omega*R-18.84955592*Omega^2*R^2*Li_l_out+9.424777961*v*b1_l_out*Omega*R+9.424777961*r*R*u*a1_l_out+9.424777961*Omega*R*u*a1_l_out+18.84955592*v*theta_1c*R*Omega+12.*u*a0_l_out*r*R+9.424777961*v*R*q+9.424777961*twist*u^2)*(R^2-1.*cr^2*R^2)/R+0.8333333333e-1*rhoh*Cla*c*(9.424777961*theta_0l*u^2*R+9.424777961*v^2*theta_0l*R-8.*theta_1c*v^2*R-12.*v*a1_l_out*u*R+8.*theta_1s*u*v*R+12.*Omega*R^2*Li_l_out*v+12.*Omega*R^2*Lc_l*v-4.*theta_1c*u^2*R-4.*v^2*b1_l_out*R-12.*w*v*R-4.*u^2*b1_l_out*R-18.84955592*u*R*v*a0_l_out)*(R-1.*cr*R)/R;
Hl_out=0.1041666667e-2*c*rhoh*(188.4955592*Cla*twist*Omega*a1_l_out+480.*Cla*twist*Omega*r*a0_l_out-188.4955592*Cla*twist*Omega*p+240.*Cla*Omega^2*twist*a0_l_out+240.*Cla*r^2*twist*a0_l_out+188.4955592*Cla*twist*r*a1_l_out+188.4955592*Cla*r^2*twist*a1_l_out+188.4955592*Cla*Omega^2*twist*a1_l_out+376.9911184*Cla*Omega*twist*r*a1_l_out-188.4955592*Cla*twist*r*p)*(R^4-1.*cr^4*R^4)/R+0.1388888889e-2*c*rhoh*(80.*Cla*twist*v*p-160.*Cla*b1_l_out*a1_l_out*R-80.*Cla*Omega*theta_1s*b1_l_out*R+188.4955592*Cla*theta_0l*r*a1_l_out*R+80.*Cla*theta_1c*r*p*R-80.*Cla*Omega*theta_1s*q*R-188.4955592*Cla*Omega*b1_l_out*a0_l_out*R+188.4955592*Cla*r^2*theta_0l*a1_l_out*R-188.4955592*Cla*r*b1_l_out*a0_l_out*R-80.*Cla*theta_1c*r*a1_l_out*R+240.*Cla*r^2*theta_0l*a0_l_out*R-80.*Cla*theta_1s*r*q*R-80.*Cla*Omega*theta_1c*a1_l_out*R-188.4955592*Cla*theta_0l*Omega*p*R+80.*Cla*twist*u*b1_l_out-376.9911184*Cla*Omega*theta_1c*r*a0_l_out*R+160.*Cla*p*b1_l_out*R+376.9911184*Cla*r*theta_0l*Omega*a1_l_out*R-240.*Cla*twist*r*v*a1_l_out-188.4955592*Cla*v*twist*r*a0_l_out-80.*Cla*twist*Omega*u*b1_l_out-188.4955592*Cla*v*twist*Omega*a0_l_out+188.4955592*Cla*theta_0l*Omega*a1_l_out*R+188.4955592*Cla*Omega^2*theta_0l*a1_l_out*R-160.*Cla*q*a1_l_out*R-188.4955592*Cla*r^2*theta_1c*a0_l_out*R-188.4955592*Cla*Omega^2*theta_1c*a0_l_out*R-80.*Cla*Omega*a1_l_out*b1_l_out*R-240.*Cla*twist*Omega*v*a1_l_out-188.4955592*Cla*Omega*q*a0_l_out*R-160.*Cla*Omega*q*a1_l_out*R-188.4955592*Cla*r*q*a0_l_out*R+80.*Cla*Omega*theta_1c*p*R+240.*Cla*Omega^2*theta_0l*a0_l_out*R-80.*Cla*Omega*p*b1_l_out*R-188.4955592*Cla*theta_0l*r*p*R+160.*Cla*q*p*R+480.*Cla*theta_0l*r*Omega*a0_l_out*R+160.*Cla*Omega*theta_1s*r*b1_l_out*R-160.*Cla*Omega^2*theta_1c*a1_l_out*R-320.*Cla*Omega*theta_1c*r*a1_l_out*R-80.*Cla*theta_1s*r*b1_l_out*R-80.*Cla*r*a1_l_out*b1_l_out*R+80.*Cla*r^2*theta_1s*b1_l_out*R-80.*Cla*r*p*b1_l_out*R+80.*Cla*twist*u*q-80.*Cla*twist*r*u*b1_l_out-160.*Cla*r^2*theta_1c*a1_l_out*R-160.*Cla*r*q*a1_l_out*R+80.*Cla*Omega^2*theta_1s*b1_l_out*R-80.*Cla*twist*v*a1_l_out)*(R^3-1.*cr^3*R^3)/R+0.2083333334e-2*c*rhoh*(47.12388980*Cla*u*a1_l_out^2*R+94.24777961*Cla*v^2*twist*a1_l_out-47.12388980*Cla*u*b1_l_out^2*R+376.9911184*Cd*u*r*R-47.12388980*Cla*theta_1c*u*b1_l_out*R+188.4955592*Cla*twist*u*Omega*Lc_l*R-188.4955592*Cla*v*theta_0l*Omega*a0_l_out*R+80.*Cla*theta_0l*u*b1_l_out*R-47.12388980*Cla*u*q*b1_l_out*R+47.12388980*Cla*theta_1s*v*b1_l_out*R-80.*Cla*theta_0l*Omega*u*b1_l_out*R+80.*Cla*theta_0l*v*p*R+47.12388980*Cla*u*theta_1c*r*b1_l_out*R+94.24777961*Cla*Omega*v*b1_l_out*a1_l_out*R-47.12388980*Cla*u*p*a1_l_out*R-188.4955592*Cla*v*theta_0l*r*a0_l_out*R-188.4955592*R^2*Cla*theta_1s*r*Omega*Li_l_out+376.9911184*R^2*Cla*p*Omega*Li_l_out-47.12388980*Cla*u*theta_1s*r*a1_l_out*R+80.*Cla*u*a0_l_out*a1_l_out*R-235.6194490*Cla*v*p*b1_l_out*R-141.3716694*Cla*theta_1s*u*a1_l_out*R+47.12388980*Cla*theta_1c*v*a1_l_out*R-188.4955592*R^2*Cla*theta_1s*r*Omega*Lc_l-188.4955592*R^2*Cla*theta_1s*Omega^2*Lc_l+47.12388980*Cla*v*q*a1_l_out*R+188.4955592*Cla*twist*u*Omega*Li_l_out*R-376.9911184*R^2*Cla*a1_l_out*Omega*Li_l_out+376.9911184*R^2*Cla*p*Omega*Lc_l+141.3716694*Cla*Omega*u*a1_l_out^2*R-188.4955592*Cla*R^2*r*Omega*Li_l_out*a1_l_out+235.6194490*Cla*v*theta_1c*r*a1_l_out*R+47.12388980*Cla*Omega*u*b1_l_out^2*R-47.12388980*Cla*u*theta_1s*Omega*a1_l_out*R-188.4955592*Cla*R^2*Omega^2*Li_l_out*a1_l_out+188.4955592*Cla*r*u*a0_l_out^2*R+141.3716694*Cla*r*u*a1_l_out^2*R+47.12388980*Cla*v*theta_1s*Omega*b1_l_out*R+188.4955592*Cla*Omega*w*a1_l_out*R-94.24777961*Cla*u*twist*v*b1_l_out-188.4955592*Cla*R^2*Omega^2*Lc_l*a1_l_out-188.4955592*Cla*R^2*r*Omega*Lc_l*a1_l_out-47.12388980*Cla*theta_1c*u*q*R+376.9911184*Cla*a1_l_out*w*R-80.*Cla*theta_0l*v*a1_l_out*R-80.*Cla*theta_1s*r*u*a0_l_out*R-80.*Cla*theta_1s*Omega*u*a0_l_out*R+47.12388980*Cla*u*theta_1c*Omega*b1_l_out*R+94.24777961*Cla*r*v*b1_l_out*a1_l_out*R-376.9911184*R^2*Cla*a1_l_out*Omega*Lc_l-188.4955592*R^2*Cla*theta_1s*Omega^2*Li_l_out+188.4955592*Cla*Omega*u*a0_l_out^2*R+188.4955592*Cla*theta_1s*Omega*w*R+188.4955592*Cla*theta_1s*r*w*R+47.12388980*Cla*r*u*b1_l_out^2*R+282.7433388*Cla*v*b1_l_out*a1_l_out*R+188.4955592*Cla*r*w*a1_l_out*R-47.12388980*Cla*theta_1c*v*p*R+80.*Cla*theta_0l*u*q*R+47.12388980*Cla*v*theta_1s*r*b1_l_out*R-240.*Cla*theta_0l*Omega*v*a1_l_out*R+320.*Cla*Omega*u*a0_l_out*a1_l_out*R+141.3716694*Cla*theta_1s*u*p*R+47.12388980*Cla*theta_1s*v*q*R-80.*Cla*u*p*a0_l_out*R+235.6194490*Cla*v*theta_1c*Omega*a1_l_out*R-240.*R^2*Cla*Omega^2*Lc_l*a0_l_out-240.*Cla*theta_0l*v*r*a1_l_out*R+320.*Cla*r*u*a1_l_out*a0_l_out*R+160.*Cla*r*v*b1_l_out*a0_l_out*R-240.*R^2*Cla*Omega^2*Li_l_out*a0_l_out-240.*R^2*Cla*r*Omega*Lc_l*a0_l_out+240.*Cla*r*w*a0_l_out*R+240.*Cla*theta_1c*v*Omega*a0_l_out*R-80.*Cla*theta_0l*r*u*b1_l_out*R+240.*Cla*theta_1c*v*r*a0_l_out*R-240.*R^2*Cla*r*Omega*Li_l_out*a0_l_out+160.*Cla*Omega*v*a0_l_out*b1_l_out*R+240.*Cla*Omega*w*a0_l_out*R+376.9911184*Cd*Omega*u*R-376.9911184*Cla*p*w*R-188.4955592*Cla*twist*u*w+80.*Cla*v^2*twist*a0_l_out)*(R^2-1.*cr^2*R^2)/R+0.4166666667e-2*c*rhoh*(-94.24777961*Cla*u*theta_1s*v*a0_l_out*R+188.4955592*Cla*v*w*a0_l_out*R+80.*R^2*Cla*theta_1s*v*Omega*Lc_l-188.4955592*Cla*theta_0l*u*w*R-80.*R^2*Cla*u*b1_l_out*Omega*Li_l_out-80.*R^2*Cla*theta_1c*u*Omega*Li_l_out-80.*R^2*Cla*u*b1_l_out*Omega*Lc_l-188.4955592*Cla*v*u*a1_l_out*a0_l_out*R-16.*Cla*u*theta_1s*v*a1_l_out*R-160.*Cd*u*v*R+188.4955592*R^2*Cla*theta_0l*u*Omega*Li_l_out+188.4955592*Cla*v^2*a0_l_out*b1_l_out*R+188.4955592*R^2*Cla*theta_0l*u*Omega*Lc_l+80.*Cla*theta_1c*u*w*R-94.24777961*Cla*u*theta_0l*v*b1_l_out*R-188.4955592*Cla*R^2*v*Omega*Lc_l*a0_l_out+80.*Cla*w*u*b1_l_out*R-94.24777961*Cla*v^2*theta_1c*a0_l_out*R+94.24777961*Cla*v^2*theta_0l*a1_l_out*R-188.4955592*Cla*R^2*v*Omega*Li_l_out*a0_l_out-80.*Cla*v*a0_l_out^2*u*R-80.*R^2*Cla*theta_1c*u*Omega*Lc_l+80.*R^2*Cla*theta_1s*v*Omega*Li_l_out-80.*Cla*theta_1s*v*w*R-96.*Cla*v^2*theta_1c*a1_l_out*R+16.*Cla*v*u*b1_l_out^2*R+32.*Cla*v^2*b1_l_out*a1_l_out*R+16.*Cla*theta_1c*u*v*b1_l_out*R-96.*Cla*v*u*a1_l_out^2*R-16.*Cla*theta_1s*v^2*b1_l_out*R+80.*Cla*theta_0l*v^2*a0_l_out*R)*(R-1.*cr*R)/R;
Sl_out=-0.1041666667e-2*c*rhoh*(376.9911184*Cla*Omega*twist*r*b1_l_out+188.4955592*Cla*twist*Omega*b1_l_out+188.4955592*Cla*r^2*twist*b1_l_out+188.4955592*Cla*twist*Omega*q+188.4955592*Cla*twist*r*q+188.4955592*Cla*Omega^2*twist*b1_l_out+188.4955592*Cla*twist*r*b1_l_out)*(R^4-1.*cr^4*R^4)/R-0.1388888889e-2*c*rhoh*(188.4955592*Cla*theta_0l*Omega*q*R+188.4955592*Cla*theta_0l*Omega*b1_l_out*R-80.*Cla*theta_1s*r*a1_l_out*R-160.*Cla*theta_1c*r*q*R+240.*Cla*twist*Omega^2*R*Li_l_out+240.*Cla*twist*Omega^2*R*Lc_l+240.*Cla*twist*r*Omega*R*Li_l_out-320.*Cla*u*twist*r*a1_l_out-160.*Cla*b1_l_out^2*R+188.4955592*Cla*theta_0l*r*q*R-80.*Cla*Omega*b1_l_out^2*R+80.*Cla*r*a1_l_out^2*R-160.*Cla*twist*v*b1_l_out-80.*Cla*p^2*R-80.*Cla*a1_l_out^2*R-160.*Cla*q^2*R+240.*Cd*R*r^2+240.*Cla*twist*r*Omega*R*Lc_l-160.*Cla*theta_1c*r*b1_l_out*R+80.*Cla*Omega^2*theta_1s*a1_l_out*R+188.4955592*Cla*theta_0l*r*b1_l_out*R-320.*Cla*twist*Omega*u*a1_l_out-240.*Cla*twist*v*r*b1_l_out+376.9911184*Cla*Omega*theta_1s*r*a0_l_out*R-80.*Cla*r*q*b1_l_out*R+240.*Cd*R*Omega^2-80.*Cla*Omega^2*theta_1c*b1_l_out*R+188.4955592*Cla*r^2*theta_0l*b1_l_out*R-188.4955592*Cla*r*p*a0_l_out*R+480.*Cd*R*Omega*r-320.*Cla*q*b1_l_out*R+80.*Cla*Omega*a1_l_out^2*R-160.*Cla*Omega*theta_1c*q*R+188.4955592*Cla*Omega*a1_l_out*a0_l_out*R+188.4955592*Cla*Omega^2*theta_1s*a0_l_out*R+80.*Cla*Omega*theta_1s*p*R-80.*Cla*r^2*theta_1c*b1_l_out*R+188.4955592*Cla*r*a1_l_out*a0_l_out*R-188.4955592*Cla*Omega*p*a0_l_out*R-240.*Cla*twist*Omega*v*b1_l_out-80.*Cla*Omega*p*a1_l_out*R+188.4955592*Cla*r^2*theta_1s*a0_l_out*R+188.4955592*Cla*Omega^2*theta_0l*b1_l_out*R+160.*Cla*Omega*theta_1s*r*a1_l_out*R+376.9911184*Cla*r*theta_0l*Omega*b1_l_out*R-565.4866776*Cla*twist*r*u*a0_l_out+80.*Cla*r^2*theta_1s*a1_l_out*R-160.*Cla*Omega*theta_1c*r*b1_l_out*R-160.*Cla*twist*v*q+160.*Cla*p*a1_l_out*R-80.*Cla*Omega*theta_1s*a1_l_out*R-80.*Cla*u*twist*p+80.*Cla*u*twist*a1_l_out-240.*Cla*twist*Omega*w-240.*Cla*twist*r*w-80.*Cla*r*b1_l_out^2*R+80.*Cla*theta_1s*r*p*R-160.*Cla*Omega*theta_1c*b1_l_out*R-80.*Cla*r*p*a1_l_out*R-80.*Cla*Omega*q*b1_l_out*R-565.4866776*Cla*twist*Omega*u*a0_l_out)*(R^3-1.*cr^3*R^3)/R-0.2083333334e-2*c*rhoh*(-565.4866776*Cla*theta_0l*Omega*u*a0_l_out*R+240.*Cla*v*a0_l_out*p*R+160.*Cla*r*u*b1_l_out*a0_l_out*R+80.*Cla*theta_0l*u*a1_l_out*R+188.4955592*Cla*twist*v*w+376.9911184*Cla*b1_l_out*w*R-376.9911184*Cd*v*r*R+94.24777961*Cla*v^2*twist*b1_l_out+188.4955592*Cla*u^2*twist*b1_l_out+188.4955592*Cla*theta_1c*r*w*R-188.4955592*Cla*twist*v*Omega*Lc_l*R+400.*Cla*u*q*a0_l_out*R-240.*Cla*theta_0l*R*Omega*w-240.*Cla*theta_0l*R*r*w+240.*Cla*theta_0l*R^2*Omega^2*Li_l_out+94.24777961*Cla*b1_l_out*u*a1_l_out*R+240.*Cla*theta_0l*R^2*Omega^2*Lc_l-47.12388980*Cla*u*theta_1s*b1_l_out*R-47.12388980*Cla*theta_1s*v*p*R+188.4955592*Cla*theta_1c*Omega*w*R-188.4955592*R^2*Cla*theta_1c*r*Omega*Li_l_out+240.*Cla*theta_0l*R^2*r*Omega*Li_l_out+240.*Cla*theta_0l*R^2*r*Omega*Lc_l-240.*Cla*v*a0_l_out*a1_l_out*R-240.*Cla*v*theta_0l*Omega*b1_l_out*R-329.8672286*Cla*theta_1s*r*u*b1_l_out*R+329.8672286*Cla*q*u*a1_l_out*R-240.*Cla*theta_1s*Omega*v*a0_l_out*R-240.*Cla*theta_1s*r*v*a0_l_out*R+94.24777961*Cla*r*u*a1_l_out*b1_l_out*R+47.12388980*Cla*Omega*v*a1_l_out^2*R-329.8672286*Cla*theta_1s*Omega*u*b1_l_out*R+141.3716694*Cla*Omega*v*b1_l_out^2*R+141.3716694*Cla*r*v*b1_l_out^2*R+400.*Cla*twist*u*v*a0_l_out+47.12388980*Cla*theta_1c*u*p*R+235.6194490*Cla*u*p*b1_l_out*R+400.*Cla*u*b1_l_out*a0_l_out*R+141.3716694*Cla*v*theta_1c*r*b1_l_out*R+141.3716694*Cla*v*q*b1_l_out*R+188.4955592*Cla*Omega*v*a0_l_out^2*R-188.4955592*Cla*R^2*Omega^2*Li_l_out*b1_l_out-320.*Cla*theta_0l*u*r*a1_l_out*R+160.*Cla*r*v*a1_l_out*a0_l_out*R-141.3716694*Cla*v*a1_l_out^2*R+94.24777961*Cla*Omega*u*b1_l_out*a1_l_out*R-240.*Cla*v*theta_0l*r*b1_l_out*R+141.3716694*Cla*v*theta_1c*Omega*b1_l_out*R-188.4955592*Cla*R^2*Omega^2*Lc_l*b1_l_out-188.4955592*Cla*R^2*r*Omega*Lc_l*b1_l_out-188.4955592*Cla*R^2*r*Omega*Li_l_out*b1_l_out+282.7433388*Cla*twist*u*v*a1_l_out+188.4955592*Cla*r*v*a0_l_out^2*R+188.4955592*Cla*Omega*w*b1_l_out*R+160.*Cla*Omega*u*b1_l_out*a0_l_out*R-188.4955592*Cla*twist*v*Omega*Li_l_out*R+47.12388980*Cla*r*v*a1_l_out^2*R-376.9911184*R^2*Cla*q*Omega*Lc_l-376.9911184*R^2*Cla*b1_l_out*Omega*Lc_l-376.9911184*R^2*Cla*b1_l_out*Omega*Li_l_out-188.4955592*R^2*Cla*theta_1c*Omega^2*Li_l_out+47.12388980*Cla*theta_1s*v*a1_l_out*R-188.4955592*R^2*Cla*theta_1c*Omega^2*Lc_l-141.3716694*Cla*v*theta_1s*Omega*a1_l_out*R-141.3716694*Cla*v*theta_1s*r*a1_l_out*R+141.3716694*Cla*v*p*a1_l_out*R+160.*Cla*Omega*v*a1_l_out*a0_l_out*R+320.*Cla*theta_1c*Omega*u*a0_l_out*R-565.4866776*Cla*theta_0l*r*u*a0_l_out*R-160.*Cla*v*theta_0l*b1_l_out*R+235.6194490*Cla*theta_1c*r*u*a1_l_out*R+141.3716694*Cla*v*b1_l_out^2*R+376.9911184*Cla*q*w*R-376.9911184*Cd*Omega*v*R+141.3716694*Cla*theta_1c*v*b1_l_out*R+188.4955592*Cla*r*w*b1_l_out*R-80.*Cla*theta_0l*u*p*R-376.9911184*R^2*Cla*q*Omega*Li_l_out-47.12388980*Cla*u*theta_1s*q*R+320.*Cla*theta_1c*u*r*a0_l_out*R-188.4955592*R^2*Cla*theta_1c*r*Omega*Lc_l-320.*Cla*theta_0l*Omega*u*a1_l_out*R+141.3716694*Cla*theta_1c*v*q*R-47.12388980*Cla*theta_1c*u*a1_l_out*R-160.*Cla*v*theta_0l*q*R+235.6194490*Cla*theta_1c*Omega*u*a1_l_out*R)*(R^2-1.*cr^2*R^2)/R-0.4166666667e-2*c*rhoh*(188.4955592*Cla*u^2*theta_1s*a0_l_out*R+188.4955592*Cla*theta_0l*u^2*b1_l_out*R-565.4866776*Cla*u*v*b1_l_out*a0_l_out*R-240.*Cla*Omega^2*R^3*Li_l_out^2-240.*Cla*Omega^2*R^3*Lc_l^2+176.*Cla*u*theta_1s*v*b1_l_out*R+400.*Cla*theta_0l*u*v*a0_l_out*R-80.*R^2*Cla*theta_1s*u*Omega*Lc_l+94.24777961*Cla*v^2*theta_1s*a0_l_out*R-188.4955592*Cla*v^2*a0_l_out*a1_l_out*R-160.*Cla*v*theta_1c*w*R-80.*R^2*Cla*theta_1s*u*Omega*Li_l_out-160.*Cla*v^2*a0_l_out^2*R+400.*R^2*Cla*u*a1_l_out*Omega*Li_l_out+282.7433388*Cla*theta_0l*u*v*a1_l_out*R-188.4955592*R^2*Cla*theta_0l*v*Omega*Lc_l+565.4866776*R^2*Cla*u*a0_l_out*Omega*Li_l_out+565.4866776*R^2*Cla*u*a0_l_out*Omega*Lc_l+80.*Cla*u*theta_1s*w*R-480.*Cla*Omega^2*R^3*Li_l_out*Lc_l-240.*Cla*R*w^2-288.*Cla*v*u*a1_l_out*b1_l_out*R-400.*Cla*u*w*a1_l_out*R-64.*Cla*v^2*theta_1c*b1_l_out*R+80.*Cla*u^2*theta_1s*a1_l_out*R+480.*Cla*R^2*w*Omega*Li_l_out-224.*Cla*theta_1c*u*v*a1_l_out*R+160.*R^2*Cla*theta_1c*v*Omega*Lc_l-160.*Cla*u^2*a1_l_out^2*R+480.*Cla*R^2*w*Omega*Lc_l-240.*Cla*v*b1_l_out*w*R-80.*Cla*theta_1c*u^2*b1_l_out*R+240.*R^2*Cla*v*b1_l_out*Omega*Li_l_out+160.*R^2*Cla*theta_1c*v*Omega*Li_l_out+240.*R^2*Cla*v*b1_l_out*Omega*Lc_l+64.*Cla*v^2*theta_1s*a1_l_out*R+160.*Cd*v^2*R+80.*Cd*u^2*R+188.4955592*Cla*theta_0l*v*w*R-80.*Cla*u^2*b1_l_out^2*R-64.*Cla*v^2*a1_l_out^2*R-282.7433388*Cla*theta_1c*v*u*a0_l_out*R+94.24777961*Cla*v^2*theta_0l*b1_l_out*R-565.4866776*Cla*u*a0_l_out*w*R-188.4955592*R^2*Cla*theta_0l*v*Omega*Li_l_out+400.*R^2*Cla*u*Omega*Lc_l*a1_l_out-96.*Cla*v^2*b1_l_out^2*R-376.9911184*Cla*u^2*a1_l_out*a0_l_out*R-240.*Cla*u^2*a0_l_out^2*R)*(R-1.*cr*R)/R;
Ql_out=0.4166666666e-2*rhoh*c*(-48.*Cla*twist*r*b1_l_out-48.*Cla*twist*Omega*b1_l_out-48.*Cla*twist*r*q-48.*Cla*twist*Omega*q)*(R^5-1.*cr^5*R^5)/R+0.5208333332e-2*rhoh*c*(-48.*Cla*theta_0l*Omega*q*R-48.*Cla*theta_0l*Omega*b1_l_out*R+37.69911184*Cla*theta_1s*r*a1_l_out*R+37.69911184*Cla*theta_1c*r*q*R-75.39822369*Cla*twist*Omega^2*R*Li_l_out-75.39822369*Cla*twist*Omega^2*R*Lc_l-75.39822369*Cla*twist*r*Omega*R*Li_l_out+37.69911184*Cla*u*twist*r*a1_l_out+37.69911184*Cla*b1_l_out^2*R-48.*Cla*theta_0l*r*q*R+37.69911184*Cla*twist*v*b1_l_out+37.69911184*Cla*p^2*R+37.69911184*Cla*a1_l_out^2*R+37.69911184*Cla*q^2*R-75.39822369*Cd*R*r^2-75.39822369*Cla*twist*r*Omega*R*Lc_l+37.69911184*Cla*theta_1c*r*b1_l_out*R-48.*Cla*theta_0l*r*b1_l_out*R+37.69911184*Cla*twist*Omega*u*a1_l_out+37.69911184*Cla*twist*v*r*b1_l_out-75.39822369*Cd*R*Omega^2-150.7964474*Cd*R*Omega*r+75.39822369*Cla*q*b1_l_out*R+37.69911184*Cla*Omega*theta_1c*q*R-37.69911184*Cla*Omega*theta_1s*p*R+37.69911184*Cla*twist*Omega*v*b1_l_out+48.*Cla*twist*r*u*a0_l_out+37.69911184*Cla*twist*v*q-75.39822369*Cla*p*a1_l_out*R+37.69911184*Cla*Omega*theta_1s*a1_l_out*R+37.69911184*Cla*u*twist*p-37.69911184*Cla*u*twist*a1_l_out+75.39822369*Cla*twist*Omega*w+75.39822369*Cla*twist*r*w-37.69911184*Cla*theta_1s*r*p*R+37.69911184*Cla*Omega*theta_1c*b1_l_out*R+48.*Cla*twist*Omega*u*a0_l_out)*(R^4-1.*cr^4*R^4)/R+0.6944444443e-2*rhoh*c*(48.*Cla*theta_0l*Omega*u*a0_l_out*R-75.39822369*Cla*v*a0_l_out*p*R-37.69911184*Cla*theta_0l*u*a1_l_out*R-48.*Cla*twist*v*w-96.*Cla*b1_l_out*w*R+96.*Cd*v*r*R-16.*Cla*v^2*twist*b1_l_out-16.*Cla*u^2*twist*b1_l_out-48.*Cla*theta_1c*r*w*R+48.*Cla*twist*v*Omega*Lc_l*R-75.39822369*Cla*u*q*a0_l_out*R+75.39822369*Cla*theta_0l*R*Omega*w+75.39822369*Cla*theta_0l*R*r*w-75.39822369*Cla*theta_0l*R^2*Omega^2*Li_l_out-32.*Cla*b1_l_out*u*a1_l_out*R-75.39822369*Cla*theta_0l*R^2*Omega^2*Lc_l+16.*Cla*u*theta_1s*b1_l_out*R+16.*Cla*theta_1s*v*p*R-48.*Cla*theta_1c*Omega*w*R+48.*R^2*Cla*theta_1c*r*Omega*Li_l_out-75.39822369*Cla*theta_0l*R^2*r*Omega*Li_l_out-75.39822369*Cla*theta_0l*R^2*r*Omega*Lc_l+75.39822369*Cla*v*a0_l_out*a1_l_out*R+37.69911184*Cla*v*theta_0l*Omega*b1_l_out*R+16.*Cla*theta_1s*r*u*b1_l_out*R-64.*Cla*q*u*a1_l_out*R+37.69911184*Cla*theta_1s*Omega*v*a0_l_out*R+37.69911184*Cla*theta_1s*r*v*a0_l_out*R+16.*Cla*theta_1s*Omega*u*b1_l_out*R-75.39822369*Cla*twist*u*v*a0_l_out-16.*Cla*theta_1c*u*p*R-32.*Cla*u*p*b1_l_out*R-75.39822369*Cla*u*b1_l_out*a0_l_out*R-16.*Cla*v*theta_1c*r*b1_l_out*R-32.*Cla*v*q*b1_l_out*R+37.69911184*Cla*theta_0l*u*r*a1_l_out*R+32.*Cla*v*a1_l_out^2*R+37.69911184*Cla*v*theta_0l*r*b1_l_out*R-16.*Cla*v*theta_1c*Omega*b1_l_out*R-48.*Cla*twist*u*v*a1_l_out+48.*Cla*twist*v*Omega*Li_l_out*R+96.*R^2*Cla*q*Omega*Lc_l+96.*R^2*Cla*b1_l_out*Omega*Lc_l+96.*R^2*Cla*b1_l_out*Omega*Li_l_out+48.*R^2*Cla*theta_1c*Omega^2*Li_l_out-16.*Cla*theta_1s*v*a1_l_out*R+48.*R^2*Cla*theta_1c*Omega^2*Lc_l+16.*Cla*v*theta_1s*Omega*a1_l_out*R+16.*Cla*v*theta_1s*r*a1_l_out*R-32.*Cla*v*p*a1_l_out*R-37.69911184*Cla*theta_1c*Omega*u*a0_l_out*R+48.*Cla*theta_0l*r*u*a0_l_out*R+37.69911184*Cla*v*theta_0l*b1_l_out*R-32.*Cla*theta_1c*r*u*a1_l_out*R-32.*Cla*v*b1_l_out^2*R-96.*Cla*q*w*R+96.*Cd*Omega*v*R-32.*Cla*theta_1c*v*b1_l_out*R+37.69911184*Cla*theta_0l*u*p*R+96.*R^2*Cla*q*Omega*Li_l_out+16.*Cla*u*theta_1s*q*R-37.69911184*Cla*theta_1c*u*r*a0_l_out*R+48.*R^2*Cla*theta_1c*r*Omega*Lc_l+37.69911184*Cla*theta_0l*Omega*u*a1_l_out*R-32.*Cla*theta_1c*v*q*R+16.*Cla*theta_1c*u*a1_l_out*R+37.69911184*Cla*v*theta_0l*q*R-32.*Cla*theta_1c*Omega*u*a1_l_out*R)*(R^3-1.*cr^3*R^3)/R+0.1041666666e-1*rhoh*c*(-16.*Cla*u^2*theta_1s*a0_l_out*R-16.*Cla*theta_0l*u^2*b1_l_out*R+64.*Cla*u*v*b1_l_out*a0_l_out*R+75.39822369*Cla*Omega^2*R^3*Li_l_out^2+75.39822369*Cla*Omega^2*R^3*Lc_l^2-37.69911184*Cla*u*theta_1s*v*b1_l_out*R-75.39822369*Cla*theta_0l*u*v*a0_l_out*R+37.69911184*R^2*Cla*theta_1s*u*Omega*Lc_l-16.*Cla*v^2*theta_1s*a0_l_out*R+32.*Cla*v^2*a0_l_out*a1_l_out*R+37.69911184*Cla*v*theta_1c*w*R+37.69911184*R^2*Cla*theta_1s*u*Omega*Li_l_out+37.69911184*Cla*v^2*a0_l_out^2*R-75.39822369*R^2*Cla*u*a1_l_out*Omega*Li_l_out-48.*Cla*theta_0l*u*v*a1_l_out*R+48.*R^2*Cla*theta_0l*v*Omega*Lc_l-96.*R^2*Cla*u*a0_l_out*Omega*Li_l_out-96.*R^2*Cla*u*a0_l_out*Omega*Lc_l-37.69911184*Cla*u*theta_1s*w*R+150.7964474*Cla*Omega^2*R^3*Li_l_out*Lc_l+75.39822369*Cla*R*w^2+37.69911184*Cla*v*u*a1_l_out*b1_l_out*R+75.39822369*Cla*u*w*a1_l_out*R+9.424777961*Cla*v^2*theta_1c*b1_l_out*R-9.424777961*Cla*u^2*theta_1s*a1_l_out*R-150.7964474*Cla*R^2*w*Omega*Li_l_out+37.69911184*Cla*theta_1c*u*v*a1_l_out*R-37.69911184*R^2*Cla*theta_1c*v*Omega*Lc_l+28.27433388*Cla*u^2*a1_l_out^2*R-150.7964474*Cla*R^2*w*Omega*Lc_l+75.39822369*Cla*v*b1_l_out*w*R+9.424777961*Cla*theta_1c*u^2*b1_l_out*R-75.39822369*R^2*Cla*v*b1_l_out*Omega*Li_l_out-37.69911184*R^2*Cla*theta_1c*v*Omega*Li_l_out-75.39822369*R^2*Cla*v*b1_l_out*Omega*Lc_l-9.424777961*Cla*v^2*theta_1s*a1_l_out*R-37.69911184*Cd*v^2*R-37.69911184*Cd*u^2*R-48.*Cla*theta_0l*v*w*R+9.424777961*Cla*u^2*b1_l_out^2*R+9.424777961*Cla*v^2*a1_l_out^2*R+48.*Cla*theta_1c*v*u*a0_l_out*R-16.*Cla*v^2*theta_0l*b1_l_out*R+96.*Cla*u*a0_l_out*w*R+48.*R^2*Cla*theta_0l*v*Omega*Li_l_out-75.39822369*R^2*Cla*u*Omega*Lc_l*a1_l_out+28.27433388*Cla*v^2*b1_l_out^2*R+64.*Cla*u^2*a1_l_out*a0_l_out*R+37.69911184*Cla*u^2*a0_l_out^2*R)*(R^2-1.*cr^2*R^2)/R;

% Total rotor forces on section 1 (positive x-direction)
Tpos=Tl_in+Tl_out;  % Thrust force
Hpos=Hl_in+Hl_out;  % Longitudinal force
Spos=Sl_in+Sl_out;  % Lateral force
Qpos=Ql_in+Ql_out;  % Torque

% Determining non-dimensional coefficients lower rotor section 1 inside
% upper rotor wake
CTl_in=Tl_in/(dimless);
CHl_in=Hl_in/dimless;
CSl_in=Sl_in/dimless;
CQl_in=Ql_in/(R*dimless);

% Determining thrust coefficients inner part of section 1  inside upper rotor wake[-]
Ct_el_in = CTl_in;                                                                              % Blade element theory
Ct_gl_in = 2*Li_l_in*sqrt((mu*cos(alpha_cp-a1_l_in))^2+(mu*sin(alpha_cp-a1_l_in)+Li_l_in)^2);   % Glauert theory

% Determining non-dimensional coefficients lower rotor section 1 outside
% upper rotor wake
CTl_out=Tl_out/(dimless);
CHl_out=Hl_out/dimless;
CSl_out=Sl_out/dimless;
CQl_out=Ql_out/(R*dimless);

% Determining thrust coefficients inner part of section 1 outside upper rotor wake[-]
Ct_el_out = CTl_out;                                                                                % Blade element theory
Ct_gl_out = 2*Li_l_out*sqrt((mu*cos(alpha_cp-a1_l_out))^2+(mu*sin(alpha_cp-a1_l_out)+Li_l_out)^2);  % Glauert theory

% Total coefficients on section 1 (positive x direction) of lower rotor [-]
CTl_pos=CTl_in+CTl_out;
CHl_pos=CHl_in+CHl_out;
CSl_pos=CSl_in+CSl_out;
CQl_pos=CQl_in+CQl_out;

%-------------- Determining forces on section 2 (negative x direction)------------
% Determining attenuation coefficient for section 2

ds=R/20;                    % Stepsize of radius
dpsi_b=0.1*pi;              % Stepsize of azimuth angle

CattM2=[];                  % Making attenuation coefficient table
psi_b=1.6*pi;               % Startvalue of azimuth angle for section 1

% Determining attenuation coefficient table for section 2 (with numerical
% integration)
while psi_b+dpsi_b<=2.5*pi
Catt2=[];

for s=ds:ds:(R*j)
    mm=tan(chi);
    z0=h_nd;
    r0=(s.*j/R);
    
    dV=@(x)0.5.*(1+r0.*cos(-psi_b+x)-mm.*cos(x).*sqrt(1+r0.^2+z0.^2.+2.*r0.*...
    cos(-psi_b+x))./sqrt(1.+mm.^2))./(pi.*sqrt(1+r0.^2+z0.^2+2.*r0.*...
    cos(-psi_b+x)).*(sqrt(1+r0.^2+z0.^2+2.*r0.*cos(-psi_b+x))-(z0+mm.*...
    r0.*cos(psi_b)+mm.*cos(x))./sqrt(1+mm.^2)));
    
    Catt_t2=quad(dV,0,2*pi);
    Catt2=[Catt2; Catt_t2];
end
CattM2=[CattM2 Catt];

psi_b=psi_b+dpsi_b;
 
end

% Determining properties of attenuation coefficient table of section 2
g=size(CattM2);
length=g(1);
width=g(2);
i=round(g(2)/2);

% Determining attenuation coefficients of inner and outer part of section 2
 if chi<=atan(((1-wc)*R)/(h_nd*R))               % Situation 2.1
    [trash,cp]=max(abs(diff(CattM2(:,5))));     % Determining checkpoint (as row number)
    Catt_in2=mean(CattM2(1:cp,i));              % Attenuation coefficient for inner part of sit. 2.1
    Catt_out2=mean(CattM2(cp+1:end,i));         % Attenuation coefficient for outer part of sit. 2.1

elseif chi<=atan((R*wc)/(R*h_nd))               % Situation 2.2
    cp=g(1);                                    % Determining checkpoint (as row number)
    Catt_out2=0;                                % Attenuation coefficient for outer part of sit. 2.2
    Catt_in2=mean(CattM2(1:end,i));             % Attenuation coefficient for inner part of sit. 2.2

    
elseif chi<=atan(((R*wc)+R)/(R*h_nd))           % Situation 2.3
    [trash,cp]=max(abs(diff(CattM2(:,5))));     % Determining checkpoint (as row number)
    Catt_out2=mean(CattM2(1:cp,i));             % Attenuation coefficient for outer part of sit. 2.3
    Catt_in2=mean(CattM2(cp+1:end,i));          % Attenuation coefficient for inner part of sit. 2.3

elseif chi<=atan(((R*wc)+R)/(R*h_nd))           % Situation 2.4
    cp=0;                                       % Determining checkpoint (as row number)
    Catt_out2=mean(CattM2(cp+1:end,i));         % Attenuation coefficient for outer part of sit. 2.4
    Catt_in2=0;                                 % Attenuation coefficient for inner part of sit. 2.4
 end

% Converting row number checkpoint to radial checkpoint in order to use this radial checkpoint 
% in the BEM as starting/ending values for the different integrals
cr=cp/g(1);

% Determining total induced velocities of section 2
Li_l_in2=L0_l+Catt_in2*Li_u;        % Inside upper rotor wake
Li_l_out2=L0_l+Catt_out2*Li_u;      % Outside upper rotor wake

% Flapping coefficients inside upper rotor wake of section 2
a0_l_in2=(gamma/8*(1+mu_x^2-2*r/Omega)*theta_0l-gamma/6*mu_y*theta_1c-gamma/6*mu_x*theta_1s+...
    gamma/8*(4/5-8/5*r/Omega+2/3*mu_x^2)*theta_tw-gamma/6*(-mu_z+Li_l_in2)+gamma/12*mu_x*p/Omega+...
    gamma/12*mu_y*q/Omega)/(vb^2-2*r/Omega);
a1_l_in2=(gamma/6*mu_y*a0_l_in2+gamma/3*mu_x*theta_0l-gamma/8*mu_x*mu_y*theta_1c-...
    gamma/8*(1-2*r/Omega+3/2*mu_x^2)*theta_1s+gamma/4*mu_x*theta_tw-gamma/4*mu_x*(-mu_z+Li_l_in2)+...
    gamma/8*p/Omega-2*q/Omega)/(1-r/Omega-mu_x^2/2+mu_y^2/2);
b1_l_in2=(-gamma/6*mu_x*a0_l_in2+gamma/3*mu_y*theta_0l-gamma/8*(1-2*r/Omega+mu_x^2/2)*...
    theta_1c-gamma/8*mu_x*mu_y*theta_1s+gamma/4*mu_y*theta_tw-gamma/8*mu_y*(-mu_z+Li_l_in2)+2*p/Omega+...
    gamma/8*q/Omega)/(-1+r/Omega-mu_x^2/2+mu_y^2/2);

% Flapping coefficients outside upper rotor wake of section 2
a0_l_out2=(gamma/8*(1+mu_x^2-2*r/Omega)*theta_0l-gamma/6*mu_y*theta_1c-gamma/6*mu_x*theta_1s+...
    gamma/8*(4/5-8/5*r/Omega+2/3*mu_x^2)*theta_tw-gamma/6*(-mu_z+Li_l_out2)+gamma/12*mu_x*p/Omega+...
    gamma/12*mu_y*q/Omega)/(vb^2-2*r/Omega);
a1_l_out2=(gamma/6*mu_y*a0_l_out2+gamma/3*mu_x*theta_0l-gamma/8*mu_x*mu_y*theta_1c-...
    gamma/8*(1-2*r/Omega+3/2*mu_x^2)*theta_1s+gamma/4*mu_x*theta_tw-gamma/4*mu_x*(-mu_z+Li_l_out2)+...
    gamma/8*p/Omega-2*q/Omega)/(1-r/Omega-mu_x^2/2+mu_y^2/2);
b1_l_out2=(-gamma/6*mu_x*a0_l_out2+gamma/3*mu_y*theta_0l-gamma/8*(1-2*r/Omega+mu_x^2/2)*...
    theta_1c-gamma/8*mu_x*mu_y*theta_1s+gamma/4*mu_y*theta_tw-gamma/8*mu_y*(-mu_z+Li_l_out2)+2*p/Omega+...
    gamma/8*q/Omega)/(-1+r/Omega-mu_x^2/2+mu_y^2/2);

% Determining rotor forces of lower rotor section 2 with BEM (determined by Maple)
% Inside upper rotor wake
Tl_in2=-0.2083333333e-1*c*Cla*rhoh*(-18.84955592*Omega^2*twist-18.84955592*r^2*twist-37.69911184*Omega*twist*r)*R^3*cr^4-0.2777777778e-1*c*Cla*rhoh*(-37.69911184*Omega*theta_0l*R*r-18.84955592*r^2*theta_0l*R-24.*twist*v*r-12.*b1_l_in2*r*R-12.*q*Omega*R-24.*theta_1c*Omega*r*R-12.*b1_l_in2*Omega*R-12.*theta_1c*r^2*R-18.84955592*Omega^2*theta_0l*R-12.*q*r*R-12.*theta_1c*Omega^2*R-24.*twist*v*Omega)*R^2*cr^3-0.4166666666e-1*c*Cla*rhoh*(-9.424777961*Omega*R*u*a1_l_in2+18.84955592*r*Omega*R^2*Li_l_in2-18.84955592*r*R*w-18.84955592*v*theta_1c*R*Omega-18.84955592*v*theta_1c*R*r-9.424777961*r*R*u*a1_l_in2-9.424777961*v*b1_l_in2*r*R-9.424777961*v*b1_l_in2*Omega*R-9.424777961*v*R*b1_l_in2-9.424777961*v*R*q-9.424777961*p*u*R+9.424777961*a1_l_in2*u*R-18.84955592*Omega*R*w-24.*theta_0l*v*r*R-9.424777961*v^2*twist+18.84955592*Omega^2*R^2*Li_l_in2+18.84955592*Omega^2*R^2*Lc_l+18.84955592*theta_1s*u*r*R+12.*u*a0_l_in2*r*R+18.84955592*r*Omega*R^2*Lc_l-24.*theta_0l*v*Omega*R-9.424777961*twist*u^2+12.*u*a0_l_in2*Omega*R+18.84955592*theta_1s*u*Omega*R)*R*cr^2-0.8333333333e-1*c*Cla*rhoh*(18.84955592*u*R*v*a0_l_in2-9.424777961*v^2*theta_0l*R+8.*theta_1s*u*v*R-4.*theta_1c*u^2*R-4.*v^2*b1_l_in2*R+12.*Omega*R^2*Lc_l*v-9.424777961*theta_0l*u^2*R-4.*u^2*b1_l_in2*R+12.*Omega*R^2*Li_l_in2*v-12.*w*v*R-8.*theta_1c*v^2*R-12.*u*a1_l_in2*v*R)*cr;
Hl_in2=0.1041666667e-2*c*rhoh*(188.4955592*Cla*twist*Omega*a1_l_in2+188.4955592*Cla*r^2*twist*a1_l_in2-188.4955592*Cla*twist*Omega*p+188.4955592*Cla*twist*r*a1_l_in2-188.4955592*Cla*twist*r*p+376.9911184*Cla*Omega*twist*r*a1_l_in2-240.*Cla*Omega^2*twist*a0_l_in2-240.*Cla*r^2*twist*a0_l_in2+188.4955592*Cla*Omega^2*twist*a1_l_in2-480.*Cla*twist*Omega*r*a0_l_in2)*R^3*cr^4+0.1388888889e-2*c*rhoh*(160.*Cla*a1_l_in2*b1_l_in2*R-188.4955592*Cla*Omega*q*a0_l_in2*R+188.4955592*Cla*theta_0l*r*a1_l_in2*R+80.*Cla*r*a1_l_in2*b1_l_in2*R+80.*Cla*theta_1c*r*a1_l_in2*R+80.*Cla*Omega*theta_1c*a1_l_in2*R+240.*Cla*v*twist*Omega*a1_l_in2+80.*Cla*theta_1s*r*q*R+160.*Cla*r*q*a1_l_in2*R+160.*Cla*Omega*q*a1_l_in2*R-188.4955592*Cla*Omega*b1_l_in2*a0_l_in2*R+80.*Cla*Omega*p*b1_l_in2*R+160.*Cla*Omega^2*theta_1c*a1_l_in2*R+80.*Cla*twist*Omega*u*b1_l_in2-188.4955592*Cla*Omega^2*theta_1c*a0_l_in2*R-188.4955592*Cla*r*b1_l_in2*a0_l_in2*R-188.4955592*Cla*theta_0l*r*p*R-160.*Cla*q*p*R+80.*Cla*v*twist*a1_l_in2+160.*Cla*a1_l_in2*q*R-188.4955592*Cla*r*q*a0_l_in2*R-80.*Cla*r^2*theta_1s*b1_l_in2*R-240.*Cla*r^2*theta_0l*a0_l_in2*R+160.*Cla*r^2*theta_1c*a1_l_in2*R-188.4955592*Cla*v*twist*Omega*a0_l_in2+376.9911184*Cla*Omega*theta_0l*r*a1_l_in2*R+80.*Cla*Omega*theta_1s*q*R+188.4955592*Cla*theta_0l*Omega*a1_l_in2*R-80.*Cla*twist*u*b1_l_in2-160.*Cla*b1_l_in2*p*R+320.*Cla*Omega*theta_1c*r*a1_l_in2*R+80.*Cla*twist*r*u*b1_l_in2+188.4955592*Cla*Omega^2*theta_0l*a1_l_in2*R+80.*Cla*r*p*b1_l_in2*R-188.4955592*Cla*r^2*theta_1c*a0_l_in2*R-376.9911184*Cla*Omega*theta_1c*r*a0_l_in2*R-160.*Cla*Omega*theta_1s*r*b1_l_in2*R-80.*Cla*Omega^2*theta_1s*b1_l_in2*R-80.*Cla*Omega*theta_1c*p*R+80.*Cla*Omega*theta_1s*b1_l_in2*R-188.4955592*Cla*theta_0l*Omega*p*R+80.*Cla*Omega*b1_l_in2*a1_l_in2*R-480.*Cla*theta_0l*Omega*r*a0_l_in2*R-80.*Cla*theta_1c*r*p*R+80.*Cla*theta_1s*r*b1_l_in2*R-240.*Cla*Omega^2*theta_0l*a0_l_in2*R+188.4955592*Cla*r^2*theta_0l*a1_l_in2*R-188.4955592*Cla*v*twist*r*a0_l_in2-80.*Cla*v*twist*p-80.*Cla*twist*u*q+240.*Cla*twist*r*v*a1_l_in2)*R^2*cr^3+0.2083333334e-2*c*rhoh*(-80.*Cla*v^2*twist*a0_l_in2+47.12388980*Cla*u*a1_l_in2^2*R+376.9911184*Cd*Omega*u*R-188.4955592*Cla*twist*u*w-376.9911184*Cla*w*p*R+376.9911184*Cd*u*r*R+376.9911184*Cla*w*a1_l_in2*R+240.*R^2*Cla*Omega^2*Lc_l*a0_l_in2+47.12388980*Cla*theta_1s*v*q*R+376.9911184*R^2*Cla*Omega*Li_l_in2*p-376.9911184*R^2*Cla*Omega*Lc_l*a1_l_in2+47.12388980*Cla*theta_1c*v*a1_l_in2*R-47.12388980*Cla*theta_1c*v*p*R+188.4955592*Cla*twist*u*Omega*Li_l_in2*R-240.*Cla*r*w*a0_l_in2*R+240.*Cla*theta_0l*v*Omega*a1_l_in2*R+80.*Cla*theta_1s*Omega*u*a0_l_in2*R-80.*Cla*theta_0l*u*q*R+282.7433388*Cla*v*b1_l_in2*a1_l_in2*R+47.12388980*Cla*v*theta_1s*r*b1_l_in2*R-47.12388980*Cla*u*q*b1_l_in2*R-188.4955592*Cla*v*theta_0l*r*a0_l_in2*R+240.*R^2*Cla*r*Omega*Lc_l*a0_l_in2-47.12388980*Cla*u*theta_1s*r*a1_l_in2*R+188.4955592*Cla*twist*u*Omega*Lc_l*R-240.*Cla*Omega*w*a0_l_in2*R-47.12388980*Cla*theta_1c*u*b1_l_in2*R-188.4955592*Cla*R^2*r*Omega*Lc_l*a1_l_in2-188.4955592*Cla*R^2*Omega^2*Lc_l*a1_l_in2+188.4955592*Cla*theta_1s*r*w*R-47.12388980*Cla*theta_1c*u*q*R-188.4955592*R^2*Cla*theta_1s*Omega^2*Lc_l+94.24777961*Cla*v^2*twist*a1_l_in2-47.12388980*Cla*u*b1_l_in2^2*R-320.*Cla*Omega*u*a1_l_in2*a0_l_in2*R-188.4955592*Cla*v*theta_0l*Omega*a0_l_in2*R+47.12388980*Cla*v*q*a1_l_in2*R+235.6194490*Cla*v*theta_1c*Omega*a1_l_in2*R+47.12388980*Cla*u*theta_1c*r*b1_l_in2*R+47.12388980*Cla*Omega*u*b1_l_in2^2*R+188.4955592*Cla*r*w*a1_l_in2*R+47.12388980*Cla*u*theta_1c*Omega*b1_l_in2*R+80.*Cla*theta_0l*r*u*b1_l_in2*R-376.9911184*R^2*Cla*Omega*Li_l_in2*a1_l_in2-188.4955592*R^2*Cla*theta_1s*Omega^2*Li_l_in2+188.4955592*Cla*theta_1s*Omega*w*R-141.3716694*Cla*theta_1s*u*a1_l_in2*R+47.12388980*Cla*theta_1s*v*b1_l_in2*R+94.24777961*Cla*Omega*v*b1_l_in2*a1_l_in2*R+47.12388980*Cla*r*u*b1_l_in2^2*R+141.3716694*Cla*Omega*u*a1_l_in2^2*R-320.*Cla*r*u*a1_l_in2*a0_l_in2*R+240.*Cla*theta_0l*r*v*a1_l_in2*R+141.3716694*Cla*theta_1s*u*p*R-188.4955592*Cla*R^2*r*Omega*Li_l_in2*a1_l_in2+376.9911184*R^2*Cla*Omega*Lc_l*p-188.4955592*R^2*Cla*theta_1s*r*Omega*Li_l_in2-188.4955592*R^2*Cla*theta_1s*r*Omega*Lc_l-47.12388980*Cla*u*theta_1s*Omega*a1_l_in2*R-80.*Cla*theta_0l*u*b1_l_in2*R-80.*Cla*a1_l_in2*u*a0_l_in2*R+188.4955592*Cla*Omega*u*a0_l_in2^2*R+141.3716694*Cla*r*u*a1_l_in2^2*R-160.*Cla*Omega*v*a0_l_in2*b1_l_in2*R+80.*Cla*u*a0_l_in2*p*R-80.*Cla*theta_0l*v*p*R+80.*Cla*theta_1s*r*u*a0_l_in2*R-240.*Cla*theta_1c*v*r*a0_l_in2*R+235.6194490*Cla*v*theta_1c*r*a1_l_in2*R-47.12388980*Cla*u*p*a1_l_in2*R+80.*Cla*theta_0l*v*a1_l_in2*R-160.*Cla*r*v*b1_l_in2*a0_l_in2*R+80.*Cla*theta_0l*Omega*u*b1_l_in2*R-240.*Cla*theta_1c*v*Omega*a0_l_in2*R+47.12388980*Cla*v*theta_1s*Omega*b1_l_in2*R+188.4955592*Cla*Omega*w*a1_l_in2*R-235.6194490*Cla*v*p*b1_l_in2*R+94.24777961*Cla*r*v*b1_l_in2*a1_l_in2*R+188.4955592*Cla*r*u*a0_l_in2^2*R-94.24777961*Cla*u*twist*v*b1_l_in2-188.4955592*Cla*R^2*Omega^2*Li_l_in2*a1_l_in2+240.*R^2*Cla*r*Omega*Li_l_in2*a0_l_in2+240.*R^2*Cla*Omega^2*Li_l_in2*a0_l_in2)*R*cr^2+0.4166666667e-2*c*rhoh*(-32.*Cla*v^2*b1_l_in2*a1_l_in2*R+188.4955592*R^2*Cla*theta_0l*u*Omega*Lc_l+16.*Cla*theta_1s*v*u*a1_l_in2*R-16.*Cla*theta_1c*v*u*b1_l_in2*R-80.*R^2*Cla*theta_1s*v*Omega*Lc_l+80.*R^2*Cla*theta_1c*u*Omega*Li_l_in2-188.4955592*Cla*theta_0l*u*w*R+16.*Cla*v^2*theta_1s*b1_l_in2*R+188.4955592*Cla*v^2*b1_l_in2*a0_l_in2*R+94.24777961*Cla*v^2*theta_0l*a1_l_in2*R-94.24777961*Cla*u*theta_1s*v*a0_l_in2*R+80.*Cla*theta_1s*v*w*R+80.*R^2*Cla*Omega*Lc_l*u*b1_l_in2+96.*Cla*u*v*a1_l_in2^2*R+188.4955592*R^2*Cla*theta_0l*u*Omega*Li_l_in2-94.24777961*Cla*v^2*theta_1c*a0_l_in2*R-94.24777961*Cla*u*theta_0l*v*b1_l_in2*R+80.*R^2*Cla*theta_1c*u*Omega*Lc_l-16.*Cla*v*b1_l_in2^2*u*R+188.4955592*Cla*v*w*a0_l_in2*R+160.*Cd*u*v*R-188.4955592*Cla*R^2*v*Omega*Lc_l*a0_l_in2-188.4955592*Cla*R^2*v*Omega*Li_l_in2*a0_l_in2-80.*R^2*Cla*theta_1s*v*Omega*Li_l_in2-80.*Cla*w*u*b1_l_in2*R-188.4955592*Cla*u*v*a0_l_in2*a1_l_in2*R+80.*Cla*u*a0_l_in2^2*v*R-80.*Cla*theta_1c*u*w*R+96.*Cla*v^2*theta_1c*a1_l_in2*R+80.*R^2*Cla*Omega*Li_l_in2*u*b1_l_in2-80.*Cla*v^2*theta_0l*a0_l_in2*R)*cr;
Sl_in2=-0.1041666667e-2*c*rhoh*(188.4955592*Cla*twist*r*q+188.4955592*Cla*r^2*twist*b1_l_in2+188.4955592*Cla*twist*r*b1_l_in2+188.4955592*Cla*twist*Omega*b1_l_in2+188.4955592*Cla*Omega^2*twist*b1_l_in2+376.9911184*Cla*Omega*twist*r*b1_l_in2+188.4955592*Cla*twist*Omega*q)*R^3*cr^4-0.1388888889e-2*c*rhoh*(80.*Cla*a1_l_in2^2*R-240.*Cd*R*r^2-240.*Cd*R*Omega^2-80.*Cla*theta_1s*r*p*R-160.*Cla*theta_1s*Omega*r*a1_l_in2*R+80.*Cla*p^2*R+160.*Cla*b1_l_in2^2*R+188.4955592*Cla*Omega*a1_l_in2*a0_l_in2*R-80.*Cla*r*a1_l_in2^2*R-80.*Cla*Omega*a1_l_in2^2*R+80.*Cla*Omega*b1_l_in2^2*R+188.4955592*Cla*theta_0l*r*b1_l_in2*R-240.*Cla*twist*r*Omega*R*Li_l_in2+188.4955592*Cla*theta_0l*Omega*q*R-240.*Cla*twist*Omega^2*R*Li_l_in2-240.*Cla*twist*Omega^2*R*Lc_l+80.*Cla*r*p*a1_l_in2*R-80.*Cla*Omega^2*theta_1s*a1_l_in2*R+188.4955592*Cla*theta_0l*Omega*b1_l_in2*R+80.*Cla*Omega*p*a1_l_in2*R+80.*Cla*r*q*b1_l_in2*R+188.4955592*Cla*theta_0l*r*q*R+80.*Cla*theta_1s*Omega*a1_l_in2*R-240.*Cla*twist*r*Omega*R*Lc_l+376.9911184*Cla*Omega*theta_1s*r*a0_l_in2*R-188.4955592*Cla*Omega*p*a0_l_in2*R+188.4955592*Cla*r*a1_l_in2*a0_l_in2*R+160.*Cla*theta_1c*r*b1_l_in2*R+160.*Cla*theta_1c*r*q*R-80.*Cla*r^2*theta_1s*a1_l_in2*R+80.*Cla*Omega*q*b1_l_in2*R+376.9911184*Cla*Omega*theta_0l*r*b1_l_in2*R-480.*Cd*R*Omega*r+240.*Cla*twist*r*w+240.*Cla*twist*Omega*w+160.*Cla*v*twist*q-80.*Cla*twist*u*a1_l_in2+188.4955592*Cla*r^2*theta_1s*a0_l_in2*R+188.4955592*Cla*Omega^2*theta_1s*a0_l_in2*R+188.4955592*Cla*Omega^2*theta_0l*b1_l_in2*R-188.4955592*Cla*r*p*a0_l_in2*R+160.*Cla*theta_1c*Omega*q*R+320.*Cla*b1_l_in2*q*R+80.*Cla*twist*u*p+80.*Cla*r*b1_l_in2^2*R+160.*Cla*v*twist*b1_l_in2+188.4955592*Cla*r^2*theta_0l*b1_l_in2*R-565.4866776*Cla*twist*r*u*a0_l_in2+320.*Cla*twist*u*Omega*a1_l_in2+160.*Cla*theta_1c*Omega*r*b1_l_in2*R+80.*Cla*theta_1s*r*a1_l_in2*R+80.*Cla*Omega^2*theta_1c*b1_l_in2*R+320.*Cla*twist*u*r*a1_l_in2+240.*Cla*twist*Omega*v*b1_l_in2-565.4866776*Cla*twist*Omega*u*a0_l_in2+240.*Cla*twist*r*v*b1_l_in2+80.*Cla*r^2*theta_1c*b1_l_in2*R-80.*Cla*theta_1s*Omega*p*R-160.*Cla*p*a1_l_in2*R+160.*Cla*theta_1c*Omega*b1_l_in2*R+160.*Cla*q^2*R)*R^2*cr^3-0.2083333334e-2*c*rhoh*(320.*Cla*u*theta_0l*Omega*a1_l_in2*R-160.*Cla*r*v*a0_l_in2*a1_l_in2*R-188.4955592*Cla*R^2*r*Omega*Lc_l*b1_l_in2-188.4955592*Cla*R^2*Omega^2*Li_l_in2*b1_l_in2-240.*Cla*theta_0l*R^2*Omega^2*Li_l_in2-240.*Cla*theta_0l*R^2*Omega^2*Lc_l+240.*Cla*theta_0l*R*Omega*w-188.4955592*Cla*R^2*r*Omega*Li_l_in2*b1_l_in2+188.4955592*Cla*r*v*a0_l_in2^2*R-329.8672286*Cla*theta_1s*r*u*b1_l_in2*R+376.9911184*Cla*w*b1_l_in2*R-376.9911184*Cd*Omega*v*R+376.9911184*Cla*w*q*R+94.24777961*Cla*v^2*twist*b1_l_in2+141.3716694*Cla*v*b1_l_in2^2*R-141.3716694*Cla*v*a1_l_in2^2*R-240.*Cla*theta_0l*R^2*r*Omega*Li_l_in2-240.*Cla*theta_0l*R^2*r*Omega*Lc_l-376.9911184*R^2*Cla*Omega*Li_l_in2*q-376.9911184*R^2*Cla*Omega*Lc_l*q+47.12388980*Cla*theta_1s*v*a1_l_in2*R+160.*Cla*theta_0l*v*q*R+240.*Cla*theta_0l*v*r*b1_l_in2*R-188.4955592*Cla*twist*v*Omega*Li_l_in2*R+141.3716694*Cla*theta_1c*v*q*R-160.*Cla*Omega*u*a0_l_in2*b1_l_in2*R+235.6194490*Cla*theta_1c*Omega*u*a1_l_in2*R-565.4866776*Cla*theta_0l*r*u*a0_l_in2*R+282.7433388*Cla*twist*v*u*a1_l_in2+188.4955592*Cla*u^2*twist*b1_l_in2-240.*Cla*v*a0_l_in2*p*R-188.4955592*R^2*Cla*theta_1c*Omega^2*Li_l_in2-188.4955592*R^2*Cla*theta_1c*Omega^2*Lc_l-188.4955592*R^2*Cla*theta_1c*r*Omega*Lc_l-376.9911184*R^2*Cla*Omega*Lc_l*b1_l_in2-188.4955592*R^2*Cla*theta_1c*r*Omega*Li_l_in2+240.*Cla*v*a0_l_in2*a1_l_in2*R+188.4955592*Cla*r*w*b1_l_in2*R+47.12388980*Cla*Omega*v*a1_l_in2^2*R+141.3716694*Cla*v*theta_1c*Omega*b1_l_in2*R+141.3716694*Cla*r*v*b1_l_in2^2*R+47.12388980*Cla*theta_1c*u*p*R-329.8672286*Cla*theta_1s*Omega*u*b1_l_in2*R-47.12388980*Cla*theta_1c*u*a1_l_in2*R-80.*Cla*u*theta_0l*a1_l_in2*R+160.*Cla*theta_0l*v*b1_l_in2*R+94.24777961*Cla*Omega*u*a1_l_in2*b1_l_in2*R+47.12388980*Cla*r*v*a1_l_in2^2*R+235.6194490*Cla*theta_1c*r*u*a1_l_in2*R+141.3716694*Cla*theta_1c*v*b1_l_in2*R-565.4866776*Cla*theta_0l*Omega*u*a0_l_in2*R+141.3716694*Cla*Omega*v*b1_l_in2^2*R-188.4955592*Cla*R^2*Omega^2*Lc_l*b1_l_in2+141.3716694*Cla*v*p*a1_l_in2*R-141.3716694*Cla*v*theta_1s*r*a1_l_in2*R-141.3716694*Cla*v*theta_1s*Omega*a1_l_in2*R+188.4955592*Cla*Omega*w*b1_l_in2*R+94.24777961*Cla*r*u*a1_l_in2*b1_l_in2*R+188.4955592*Cla*Omega*v*a0_l_in2^2*R+141.3716694*Cla*v*theta_1c*r*b1_l_in2*R-188.4955592*Cla*twist*v*Omega*Lc_l*R+188.4955592*Cla*theta_1c*Omega*w*R+188.4955592*Cla*twist*v*w+141.3716694*Cla*v*q*b1_l_in2*R-376.9911184*R^2*Cla*Omega*Li_l_in2*b1_l_in2-320.*Cla*theta_1c*Omega*u*a0_l_in2*R-320.*Cla*theta_1c*u*r*a0_l_in2*R+240.*Cla*theta_1s*Omega*v*a0_l_in2*R+80.*Cla*u*theta_0l*p*R-47.12388980*Cla*theta_1s*v*p*R-376.9911184*Cd*v*r*R-47.12388980*Cla*theta_1s*u*q*R-160.*Cla*Omega*v*a0_l_in2*a1_l_in2*R-160.*Cla*r*u*a0_l_in2*b1_l_in2*R+235.6194490*Cla*p*u*b1_l_in2*R+240.*Cla*theta_0l*R*r*w+240.*Cla*theta_0l*Omega*v*b1_l_in2*R+188.4955592*Cla*theta_1c*r*w*R+329.8672286*Cla*q*u*a1_l_in2*R+94.24777961*Cla*b1_l_in2*u*a1_l_in2*R-47.12388980*Cla*theta_1s*u*b1_l_in2*R-400.*Cla*b1_l_in2*u*a0_l_in2*R-400.*Cla*u*twist*v*a0_l_in2+240.*Cla*v*theta_1s*r*a0_l_in2*R+320.*Cla*u*theta_0l*r*a1_l_in2*R-400.*Cla*u*q*a0_l_in2*R)*R*cr^2-0.4166666667e-2*c*rhoh*(94.24777961*Cla*v^2*theta_0l*b1_l_in2*R-376.9911184*Cla*u^2*a0_l_in2*a1_l_in2*R-176.*Cla*theta_1s*u*v*b1_l_in2*R+96.*Cla*v^2*b1_l_in2^2*R+160.*Cla*u^2*a1_l_in2^2*R-480.*Cla*R^2*w*Omega*Li_l_in2-160.*Cd*v^2*R+282.7433388*Cla*theta_0l*v*u*a1_l_in2*R+240.*Cla*u^2*a0_l_in2^2*R+240.*Cla*Omega^2*R^3*Lc_l^2-188.4955592*R^2*Cla*theta_0l*v*Omega*Lc_l+565.4866776*R^2*Cla*Omega*Lc_l*u*a0_l_in2-282.7433388*Cla*theta_1c*v*u*a0_l_in2*R+288.*Cla*v*b1_l_in2*u*a1_l_in2*R+188.4955592*Cla*theta_1s*u^2*a0_l_in2*R+188.4955592*Cla*u^2*theta_0l*b1_l_in2*R+240.*Cla*Omega^2*R^3*Li_l_in2^2-64.*Cla*theta_1s*v^2*a1_l_in2*R+64.*Cla*v^2*theta_1c*b1_l_in2*R+80.*R^2*Cla*theta_1s*u*Omega*Lc_l-188.4955592*R^2*Cla*theta_0l*v*Omega*Li_l_in2+565.4866776*R^2*Cla*Omega*Li_l_in2*u*a0_l_in2+480.*Cla*Omega^2*R^3*Lc_l*Li_l_in2-480.*Cla*R^2*w*Omega*Lc_l-400.*R^2*Cla*u*Omega*Lc_l*a1_l_in2+240.*Cla*R*w^2+64.*Cla*v^2*a1_l_in2^2*R-565.4866776*Cla*w*u*a0_l_in2*R+188.4955592*Cla*theta_0l*v*w*R-240.*R^2*Cla*v*b1_l_in2*Omega*Li_l_in2+240.*Cla*v*b1_l_in2*w*R+80.*Cla*theta_1c*u^2*b1_l_in2*R-80.*Cla*theta_1s*u^2*a1_l_in2*R-400.*Cla*theta_0l*v*u*a0_l_in2*R-565.4866776*Cla*v*u*a0_l_in2*b1_l_in2*R-188.4955592*Cla*v^2*a0_l_in2*a1_l_in2*R+94.24777961*Cla*v^2*theta_1s*a0_l_in2*R+160.*Cla*v^2*a0_l_in2^2*R-80.*Cd*u^2*R-400.*R^2*Cla*Omega*Li_l_in2*u*a1_l_in2+160.*Cla*v*theta_1c*w*R-160.*R^2*Cla*theta_1c*v*Omega*Lc_l-160.*R^2*Cla*theta_1c*v*Omega*Li_l_in2+80.*Cla*u^2*b1_l_in2^2*R-240.*R^2*Cla*v*b1_l_in2*Omega*Lc_l+80.*R^2*Cla*theta_1s*u*Omega*Li_l_in2+400.*Cla*u*w*a1_l_in2*R-80.*Cla*theta_1s*u*w*R+224.*Cla*v*theta_1c*u*a1_l_in2*R)*cr;
Ql_in2=0.4166666666e-2*rhoh*c*(48.*Cla*twist*r*q+48.*Cla*twist*r*b1_l_in2+48.*Cla*twist*Omega*q+48.*Cla*twist*Omega*b1_l_in2)*R^4*cr^5+0.5208333332e-2*rhoh*c*(37.69911184*Cla*a1_l_in2^2*R-75.39822369*Cd*R*r^2-75.39822369*Cd*R*Omega^2-37.69911184*Cla*theta_1s*r*p*R+37.69911184*Cla*p^2*R+37.69911184*Cla*b1_l_in2^2*R+48.*Cla*theta_0l*r*b1_l_in2*R-75.39822369*Cla*twist*r*Omega*R*Li_l_in2+48.*Cla*theta_0l*Omega*q*R-75.39822369*Cla*twist*Omega^2*R*Li_l_in2-75.39822369*Cla*twist*Omega^2*R*Lc_l+48.*Cla*theta_0l*Omega*b1_l_in2*R+48.*Cla*theta_0l*r*q*R+37.69911184*Cla*theta_1s*Omega*a1_l_in2*R-75.39822369*Cla*twist*r*Omega*R*Lc_l+37.69911184*Cla*theta_1c*r*b1_l_in2*R+37.69911184*Cla*theta_1c*r*q*R-150.7964474*Cd*R*Omega*r+75.39822369*Cla*twist*r*w+75.39822369*Cla*twist*Omega*w+37.69911184*Cla*v*twist*q-37.69911184*Cla*twist*u*a1_l_in2+37.69911184*Cla*theta_1c*Omega*q*R+75.39822369*Cla*b1_l_in2*q*R+37.69911184*Cla*twist*u*p+37.69911184*Cla*v*twist*b1_l_in2-48.*Cla*twist*r*u*a0_l_in2+37.69911184*Cla*twist*u*Omega*a1_l_in2+37.69911184*Cla*theta_1s*r*a1_l_in2*R+37.69911184*Cla*twist*u*r*a1_l_in2+37.69911184*Cla*twist*Omega*v*b1_l_in2-48.*Cla*twist*Omega*u*a0_l_in2+37.69911184*Cla*twist*r*v*b1_l_in2-37.69911184*Cla*theta_1s*Omega*p*R-75.39822369*Cla*p*a1_l_in2*R+37.69911184*Cla*theta_1c*Omega*b1_l_in2*R+37.69911184*Cla*q^2*R)*R^3*cr^4+0.6944444443e-2*rhoh*c*(37.69911184*Cla*u*theta_0l*Omega*a1_l_in2*R-75.39822369*Cla*theta_0l*R^2*Omega^2*Li_l_in2-75.39822369*Cla*theta_0l*R^2*Omega^2*Lc_l+75.39822369*Cla*theta_0l*R*Omega*w-16.*Cla*theta_1s*r*u*b1_l_in2*R+96.*Cla*w*b1_l_in2*R-96.*Cd*Omega*v*R+96.*Cla*w*q*R+16.*Cla*v^2*twist*b1_l_in2+32.*Cla*v*b1_l_in2^2*R-32.*Cla*v*a1_l_in2^2*R-75.39822369*Cla*theta_0l*R^2*r*Omega*Li_l_in2-75.39822369*Cla*theta_0l*R^2*r*Omega*Lc_l-96.*R^2*Cla*Omega*Li_l_in2*q-96.*R^2*Cla*Omega*Lc_l*q+16.*Cla*theta_1s*v*a1_l_in2*R+37.69911184*Cla*theta_0l*v*q*R+37.69911184*Cla*theta_0l*v*r*b1_l_in2*R-48.*Cla*twist*v*Omega*Li_l_in2*R+32.*Cla*theta_1c*v*q*R+32.*Cla*theta_1c*Omega*u*a1_l_in2*R-48.*Cla*theta_0l*r*u*a0_l_in2*R+48.*Cla*twist*v*u*a1_l_in2+16.*Cla*u^2*twist*b1_l_in2-75.39822369*Cla*v*a0_l_in2*p*R-48.*R^2*Cla*theta_1c*Omega^2*Li_l_in2-48.*R^2*Cla*theta_1c*Omega^2*Lc_l-48.*R^2*Cla*theta_1c*r*Omega*Lc_l-96.*R^2*Cla*Omega*Lc_l*b1_l_in2-48.*R^2*Cla*theta_1c*r*Omega*Li_l_in2+75.39822369*Cla*v*a0_l_in2*a1_l_in2*R+16.*Cla*v*theta_1c*Omega*b1_l_in2*R+16.*Cla*theta_1c*u*p*R-16.*Cla*theta_1s*Omega*u*b1_l_in2*R-16.*Cla*theta_1c*u*a1_l_in2*R-37.69911184*Cla*u*theta_0l*a1_l_in2*R+37.69911184*Cla*theta_0l*v*b1_l_in2*R+32.*Cla*theta_1c*r*u*a1_l_in2*R+32.*Cla*theta_1c*v*b1_l_in2*R-48.*Cla*theta_0l*Omega*u*a0_l_in2*R+32.*Cla*v*p*a1_l_in2*R-16.*Cla*v*theta_1s*r*a1_l_in2*R-16.*Cla*v*theta_1s*Omega*a1_l_in2*R+16.*Cla*v*theta_1c*r*b1_l_in2*R-48.*Cla*twist*v*Omega*Lc_l*R+48.*Cla*theta_1c*Omega*w*R+48.*Cla*twist*v*w+32.*Cla*v*q*b1_l_in2*R-96.*R^2*Cla*Omega*Li_l_in2*b1_l_in2-37.69911184*Cla*theta_1c*Omega*u*a0_l_in2*R-37.69911184*Cla*theta_1c*u*r*a0_l_in2*R+37.69911184*Cla*theta_1s*Omega*v*a0_l_in2*R+37.69911184*Cla*u*theta_0l*p*R-16.*Cla*theta_1s*v*p*R-96.*Cd*v*r*R-16.*Cla*theta_1s*u*q*R+32.*Cla*p*u*b1_l_in2*R+75.39822369*Cla*theta_0l*R*r*w+37.69911184*Cla*theta_0l*Omega*v*b1_l_in2*R+48.*Cla*theta_1c*r*w*R+64.*Cla*q*u*a1_l_in2*R+32.*Cla*b1_l_in2*u*a1_l_in2*R-16.*Cla*theta_1s*u*b1_l_in2*R-75.39822369*Cla*b1_l_in2*u*a0_l_in2*R-75.39822369*Cla*u*twist*v*a0_l_in2+37.69911184*Cla*v*theta_1s*r*a0_l_in2*R+37.69911184*Cla*u*theta_0l*r*a1_l_in2*R-75.39822369*Cla*u*q*a0_l_in2*R)*R^2*cr^3+0.1041666666e-1*rhoh*c*(16.*Cla*v^2*theta_0l*b1_l_in2*R-64.*Cla*u^2*a0_l_in2*a1_l_in2*R-37.69911184*Cla*theta_1s*u*v*b1_l_in2*R+28.27433388*Cla*v^2*b1_l_in2^2*R+28.27433388*Cla*u^2*a1_l_in2^2*R-150.7964474*Cla*R^2*w*Omega*Li_l_in2-37.69911184*Cd*v^2*R+48.*Cla*theta_0l*v*u*a1_l_in2*R+37.69911184*Cla*u^2*a0_l_in2^2*R+75.39822369*Cla*Omega^2*R^3*Lc_l^2-48.*R^2*Cla*theta_0l*v*Omega*Lc_l+96.*R^2*Cla*Omega*Lc_l*u*a0_l_in2-48.*Cla*theta_1c*v*u*a0_l_in2*R+37.69911184*Cla*v*b1_l_in2*u*a1_l_in2*R+16.*Cla*theta_1s*u^2*a0_l_in2*R+16.*Cla*u^2*theta_0l*b1_l_in2*R+75.39822369*Cla*Omega^2*R^3*Li_l_in2^2-9.424777961*Cla*theta_1s*v^2*a1_l_in2*R+9.424777961*Cla*v^2*theta_1c*b1_l_in2*R+37.69911184*R^2*Cla*theta_1s*u*Omega*Lc_l-48.*R^2*Cla*theta_0l*v*Omega*Li_l_in2+96.*R^2*Cla*Omega*Li_l_in2*u*a0_l_in2+150.7964474*Cla*Omega^2*R^3*Lc_l*Li_l_in2-150.7964474*Cla*R^2*w*Omega*Lc_l-75.39822369*R^2*Cla*u*Omega*Lc_l*a1_l_in2+75.39822369*Cla*R*w^2+9.424777961*Cla*v^2*a1_l_in2^2*R-96.*Cla*w*u*a0_l_in2*R+48.*Cla*theta_0l*v*w*R-75.39822369*R^2*Cla*v*b1_l_in2*Omega*Li_l_in2+75.39822369*Cla*v*b1_l_in2*w*R+9.424777961*Cla*theta_1c*u^2*b1_l_in2*R-9.424777961*Cla*theta_1s*u^2*a1_l_in2*R-75.39822369*Cla*theta_0l*v*u*a0_l_in2*R-64.*Cla*v*u*a0_l_in2*b1_l_in2*R-32.*Cla*v^2*a0_l_in2*a1_l_in2*R+16.*Cla*v^2*theta_1s*a0_l_in2*R+37.69911184*Cla*v^2*a0_l_in2^2*R-37.69911184*Cd*u^2*R-75.39822369*R^2*Cla*Omega*Li_l_in2*u*a1_l_in2+37.69911184*Cla*v*theta_1c*w*R-37.69911184*R^2*Cla*theta_1c*v*Omega*Lc_l-37.69911184*R^2*Cla*theta_1c*v*Omega*Li_l_in2+9.424777961*Cla*u^2*b1_l_in2^2*R-75.39822369*R^2*Cla*v*b1_l_in2*Omega*Lc_l+37.69911184*R^2*Cla*theta_1s*u*Omega*Li_l_in2+75.39822369*Cla*u*w*a1_l_in2*R-37.69911184*Cla*theta_1s*u*w*R+37.69911184*Cla*v*theta_1c*u*a1_l_in2*R)*R*cr^2;

% Outside upper rotor wake
Tl_out2=-0.2083333333e-1*rhoh*c*Cla*(-18.84955592*r^2*twist-18.84955592*Omega^2*twist-37.69911184*Omega*twist*r)*(R^4-1.*cr^4*R^4)/R-0.2777777778e-1*rhoh*c*Cla*(-24.*theta_1c*Omega*r*R-24.*twist*v*r-24.*twist*v*Omega-37.69911184*Omega*theta_0l*R*r-18.84955592*r^2*theta_0l*R-12.*b1_l_out2*Omega*R-12.*q*r*R-12.*theta_1c*Omega^2*R-12.*theta_1c*r^2*R-12.*q*Omega*R-18.84955592*Omega^2*theta_0l*R-12.*b1_l_out2*r*R)*(R^3-1.*cr^3*R^3)/R-0.4166666666e-1*rhoh*c*Cla*(-9.424777961*Omega*R*u*a1_l_out2-18.84955592*v*theta_1c*R*Omega-9.424777961*p*u*R-9.424777961*v*b1_l_out2*Omega*R-18.84955592*v*theta_1c*R*r-9.424777961*r*R*u*a1_l_out2-9.424777961*twist*u^2+18.84955592*theta_1s*u*r*R+18.84955592*r*Omega*R^2*Lc_l-9.424777961*v*b1_l_out2*r*R-9.424777961*v*R*q+18.84955592*r*Omega*R^2*Li_l_out2-24.*theta_0l*v*r*R-24.*theta_0l*v*Omega*R+12.*u*a0_l_out2*Omega*R+12.*u*a0_l_out2*r*R+18.84955592*Omega^2*R^2*Li_l_out2+18.84955592*theta_1s*u*Omega*R-18.84955592*r*R*w-9.424777961*v^2*twist-9.424777961*v*R*b1_l_out2+9.424777961*a1_l_out2*u*R-18.84955592*Omega*R*w+18.84955592*Omega^2*R^2*Lc_l)*(R^2-1.*cr^2*R^2)/R-0.8333333333e-1*rhoh*c*Cla*(-8.*theta_1c*v^2*R+8.*theta_1s*u*v*R-12.*w*v*R-4.*v^2*b1_l_out2*R-12.*u*a1_l_out2*v*R+12.*Omega*R^2*Li_l_out2*v-4.*theta_1c*u^2*R-9.424777961*theta_0l*u^2*R+18.84955592*u*R*v*a0_l_out2+12.*Omega*R^2*Lc_l*v-9.424777961*v^2*theta_0l*R-4.*u^2*b1_l_out2*R)*(R-1.*cr*R)/R;
Hl_out2=0.1041666667e-2*c*rhoh*(188.4955592*Cla*r^2*twist*a1_l_out2-188.4955592*Cla*twist*r*p-240.*Cla*Omega^2*twist*a0_l_out2+188.4955592*Cla*twist*Omega*a1_l_out2-480.*Cla*Omega*twist*r*a0_l_out2-240.*Cla*r^2*twist*a0_l_out2+188.4955592*Cla*twist*r*a1_l_out2-188.4955592*Cla*twist*Omega*p+188.4955592*Cla*Omega^2*twist*a1_l_out2+376.9911184*Cla*Omega*twist*r*a1_l_out2)*(R^4-1.*cr^4*R^4)/R+0.1388888889e-2*c*rhoh*(188.4955592*Cla*theta_0l*Omega*a1_l_out2*R+188.4955592*Cla*theta_0l*r*a1_l_out2*R+80.*Cla*r*b1_l_out2*a1_l_out2*R-160.*Cla*p*b1_l_out2*R+160.*Cla*Omega^2*theta_1c*a1_l_out2*R+160.*Cla*Omega*q*a1_l_out2*R+160.*Cla*r*q*a1_l_out2*R+80.*Cla*twist*r*u*b1_l_out2-188.4955592*Cla*theta_0l*Omega*p*R-80.*Cla*twist*u*q-80.*Cla*Omega^2*theta_1s*b1_l_out2*R+80.*Cla*Omega*b1_l_out2*a1_l_out2*R+80.*Cla*theta_1s*r*b1_l_out2*R-80.*Cla*Omega*theta_1c*p*R-480.*Cla*Omega*theta_0l*r*a0_l_out2*R+80.*Cla*r*p*b1_l_out2*R-80.*Cla*r^2*theta_1s*b1_l_out2*R+80.*Cla*v*twist*a1_l_out2-188.4955592*Cla*theta_0l*r*p*R+80.*Cla*Omega*theta_1c*a1_l_out2*R-188.4955592*Cla*Omega^2*theta_1c*a0_l_out2*R+240.*Cla*v*twist*r*a1_l_out2+160.*Cla*r^2*theta_1c*a1_l_out2*R+320.*Cla*Omega*theta_1c*r*a1_l_out2*R+80.*Cla*theta_1s*r*q*R+80.*Cla*Omega*theta_1s*b1_l_out2*R-80.*Cla*theta_1c*r*p*R-160.*Cla*q*p*R-188.4955592*Cla*v*twist*r*a0_l_out2-188.4955592*Cla*Omega*q*a0_l_out2*R-188.4955592*Cla*r*b1_l_out2*a0_l_out2*R-80.*Cla*twist*u*b1_l_out2+160.*Cla*q*a1_l_out2*R+80.*Cla*Omega*p*b1_l_out2*R-240.*Cla*r^2*theta_0l*a0_l_out2*R-240.*Cla*Omega^2*theta_0l*a0_l_out2*R+240.*Cla*v*twist*Omega*a1_l_out2-80.*Cla*v*twist*p+160.*Cla*b1_l_out2*a1_l_out2*R-160.*Cla*Omega*theta_1s*r*b1_l_out2*R+80.*Cla*Omega*theta_1s*q*R+80.*Cla*theta_1c*r*a1_l_out2*R+80.*Cla*twist*Omega*u*b1_l_out2-188.4955592*Cla*r^2*theta_1c*a0_l_out2*R+188.4955592*Cla*Omega^2*theta_0l*a1_l_out2*R-188.4955592*Cla*twist*Omega*v*a0_l_out2+376.9911184*Cla*Omega*theta_0l*r*a1_l_out2*R+188.4955592*Cla*r^2*theta_0l*a1_l_out2*R-188.4955592*Cla*Omega*b1_l_out2*a0_l_out2*R-376.9911184*Cla*Omega*theta_1c*r*a0_l_out2*R-188.4955592*Cla*r*q*a0_l_out2*R)*(R^3-1.*cr^3*R^3)/R+0.2083333334e-2*c*rhoh*(47.12388980*Cla*a1_l_out2^2*u*R+94.24777961*Cla*v^2*twist*a1_l_out2+47.12388980*Cla*theta_1s*v*q*R+188.4955592*Cla*twist*u*Omega*Lc_l*R-47.12388980*Cla*theta_1c*v*p*R+47.12388980*Cla*theta_1c*r*u*b1_l_out2*R-320.*Cla*Omega*u*a0_l_out2*a1_l_out2*R+47.12388980*Cla*theta_1c*v*a1_l_out2*R+235.6194490*Cla*theta_1c*r*v*a1_l_out2*R+235.6194490*Cla*theta_1c*Omega*v*a1_l_out2*R-47.12388980*Cla*theta_1c*u*q*R-376.9911184*R^2*Cla*a1_l_out2*Omega*Li_l_out2-47.12388980*Cla*theta_1c*u*b1_l_out2*R+376.9911184*Cla*a1_l_out2*w*R+141.3716694*Cla*r*u*a1_l_out2^2*R-188.4955592*R^2*Cla*theta_1s*Omega^2*Li_l_out2-47.12388980*Cla*u*b1_l_out2*q*R+188.4955592*Cla*theta_1s*r*w*R+47.12388980*Cla*v*theta_1s*r*b1_l_out2*R+141.3716694*Cla*theta_1s*u*p*R-80.*Cla*theta_0l*u*q*R+376.9911184*R^2*Cla*p*Omega*Lc_l-188.4955592*R^2*Cla*theta_1s*Omega^2*Lc_l-188.4955592*Cla*theta_0l*r*v*a0_l_out2*R-240.*Cla*Omega*w*a0_l_out2*R+376.9911184*Cd*u*r*R-80.*Cla*theta_0l*v*p*R+240.*R^2*Cla*r*Omega*Lc_l*a0_l_out2-141.3716694*Cla*theta_1s*u*a1_l_out2*R+240.*Cla*theta_0l*v*Omega*a1_l_out2*R+80.*Cla*p*u*a0_l_out2*R+240.*R^2*Cla*Omega^2*Li_l_out2*a0_l_out2+47.12388980*Cla*theta_1s*Omega*v*b1_l_out2*R+240.*R^2*Cla*Omega^2*Lc_l*a0_l_out2+240.*R^2*Cla*r*Omega*Li_l_out2*a0_l_out2-320.*Cla*r*u*a0_l_out2*a1_l_out2*R+80.*Cla*u*theta_1s*r*a0_l_out2*R+94.24777961*Cla*Omega*v*b1_l_out2*a1_l_out2*R-188.4955592*Cla*R^2*Omega^2*Lc_l*a1_l_out2-160.*Cla*r*v*a0_l_out2*b1_l_out2*R-80.*Cla*theta_0l*u*b1_l_out2*R-240.*Cla*v*theta_1c*Omega*a0_l_out2*R+80.*Cla*theta_1s*Omega*u*a0_l_out2*R-188.4955592*R^2*Cla*theta_1s*r*Omega*Li_l_out2+188.4955592*Cla*twist*u*Omega*Li_l_out2*R-47.12388980*Cla*u*b1_l_out2^2*R-80.*Cla*twist*v^2*a0_l_out2+47.12388980*Cla*theta_1c*Omega*u*b1_l_out2*R+47.12388980*Cla*theta_1s*v*b1_l_out2*R+80.*Cla*theta_0l*r*u*b1_l_out2*R-240.*Cla*theta_1c*r*v*a0_l_out2*R-80.*Cla*a1_l_out2*u*a0_l_out2*R-94.24777961*Cla*u*twist*v*b1_l_out2+188.4955592*Cla*theta_1s*Omega*w*R-188.4955592*Cla*v*theta_0l*Omega*a0_l_out2*R+188.4955592*Cla*Omega*u*a0_l_out2^2*R-47.12388980*Cla*p*u*a1_l_out2*R+47.12388980*Cla*v*a1_l_out2*q*R-376.9911184*Cla*p*w*R+80.*Cla*theta_0l*Omega*u*b1_l_out2*R+240.*Cla*theta_0l*r*v*a1_l_out2*R+376.9911184*R^2*Cla*p*Omega*Li_l_out2-188.4955592*R^2*Cla*theta_1s*r*Omega*Lc_l+188.4955592*Cla*Omega*w*a1_l_out2*R+80.*Cla*theta_0l*v*a1_l_out2*R-240.*Cla*r*w*a0_l_out2*R+282.7433388*Cla*v*a1_l_out2*b1_l_out2*R-160.*Cla*Omega*v*a0_l_out2*b1_l_out2*R+47.12388980*Cla*r*u*b1_l_out2^2*R-188.4955592*Cla*R^2*Omega^2*Li_l_out2*a1_l_out2+376.9911184*Cd*Omega*u*R-376.9911184*R^2*Cla*a1_l_out2*Omega*Lc_l-188.4955592*Cla*R^2*r*Omega*Li_l_out2*a1_l_out2-188.4955592*Cla*R^2*r*Omega*Lc_l*a1_l_out2+188.4955592*Cla*r*w*a1_l_out2*R+188.4955592*Cla*r*u*a0_l_out2^2*R+141.3716694*Cla*Omega*u*a1_l_out2^2*R-47.12388980*Cla*u*theta_1s*r*a1_l_out2*R-47.12388980*Cla*u*theta_1s*Omega*a1_l_out2*R-235.6194490*Cla*v*p*b1_l_out2*R+47.12388980*Cla*Omega*u*b1_l_out2^2*R+94.24777961*Cla*r*v*b1_l_out2*a1_l_out2*R-188.4955592*Cla*twist*u*w)*(R^2-1.*cr^2*R^2)/R+0.4166666667e-2*c*rhoh*(94.24777961*Cla*theta_0l*v^2*a1_l_out2*R+188.4955592*Cla*v*a0_l_out2*w*R-188.4955592*Cla*theta_0l*u*w*R-94.24777961*Cla*theta_0l*v*u*b1_l_out2*R-188.4955592*R^2*Cla*v*a0_l_out2*Omega*Lc_l-94.24777961*Cla*theta_1c*v^2*a0_l_out2*R+188.4955592*R^2*Cla*theta_0l*u*Omega*Li_l_out2-94.24777961*Cla*theta_1s*u*v*a0_l_out2*R+188.4955592*R^2*Cla*theta_0l*u*Omega*Lc_l+160.*Cd*u*v*R+96.*Cla*v*a1_l_out2^2*u*R-16.*Cla*u*theta_1c*v*b1_l_out2*R-16.*Cla*v*u*b1_l_out2^2*R-32.*Cla*v^2*b1_l_out2*a1_l_out2*R+16.*Cla*v^2*theta_1s*b1_l_out2*R+96.*Cla*theta_1c*v^2*a1_l_out2*R+16.*Cla*u*theta_1s*v*a1_l_out2*R+80.*R^2*Cla*u*b1_l_out2*Omega*Lc_l-188.4955592*Cla*u*v*a0_l_out2*a1_l_out2*R-188.4955592*R^2*Cla*v*a0_l_out2*Omega*Li_l_out2+80.*R^2*Cla*u*b1_l_out2*Omega*Li_l_out2+80.*Cla*v*u*a0_l_out2^2*R-80.*Cla*u*theta_1c*w*R+80.*Cla*theta_1s*v*w*R+80.*R^2*Cla*theta_1c*u*Omega*Lc_l-80.*R^2*Cla*theta_1s*v*Omega*Lc_l-80.*R^2*Cla*theta_1s*v*Omega*Li_l_out2+188.4955592*Cla*v^2*b1_l_out2*a0_l_out2*R+80.*R^2*Cla*theta_1c*u*Omega*Li_l_out2-80.*Cla*u*b1_l_out2*w*R-80.*Cla*theta_0l*v^2*a0_l_out2*R)*(R-1.*cr*R)/R;
Sl_out2=-0.1041666667e-2*c*rhoh*(188.4955592*Cla*Omega^2*twist*b1_l_out2+188.4955592*Cla*twist*r*q+188.4955592*Cla*twist*Omega*q+188.4955592*Cla*twist*Omega*b1_l_out2+188.4955592*Cla*r^2*twist*b1_l_out2+376.9911184*Cla*Omega*twist*r*b1_l_out2+188.4955592*Cla*twist*r*b1_l_out2)*(R^4-1.*cr^4*R^4)/R-0.1388888889e-2*c*rhoh*(-188.4955592*Cla*r*p*a0_l_out2*R+188.4955592*Cla*Omega*a1_l_out2*a0_l_out2*R+376.9911184*Cla*Omega*theta_0l*r*b1_l_out2*R+188.4955592*Cla*Omega^2*theta_1s*a0_l_out2*R+188.4955592*Cla*r^2*theta_1s*a0_l_out2*R+160.*Cla*Omega*theta_1c*b1_l_out2*R+80.*Cla*theta_1s*Omega*a1_l_out2*R+240.*Cla*twist*v*r*b1_l_out2+160.*Cla*q^2*R-240.*Cd*R*r^2-240.*Cd*R*Omega^2+80.*Cla*a1_l_out2^2*R+160.*Cla*b1_l_out2^2*R+80.*Cla*p^2*R+80.*Cla*Omega*q*b1_l_out2*R+320.*Cla*u*twist*r*a1_l_out2+160.*Cla*theta_1c*r*q*R+240.*Cla*twist*Omega*v*b1_l_out2-80.*Cla*theta_1s*r*p*R+80.*Cla*Omega^2*theta_1c*b1_l_out2*R+188.4955592*Cla*Omega^2*theta_0l*b1_l_out2*R+320.*Cla*u*twist*Omega*a1_l_out2+160.*Cla*Omega*theta_1c*q*R+160.*Cla*Omega*theta_1c*r*b1_l_out2*R+188.4955592*Cla*r*a1_l_out2*a0_l_out2*R-565.4866776*Cla*twist*r*u*a0_l_out2-188.4955592*Cla*Omega*p*a0_l_out2*R+188.4955592*Cla*r^2*theta_0l*b1_l_out2*R-80.*Cla*theta_1s*Omega*p*R+188.4955592*Cla*theta_0l*Omega*b1_l_out2*R+376.9911184*Cla*Omega*theta_1s*r*a0_l_out2*R-240.*Cla*twist*Omega^2*R*Lc_l-240.*Cla*twist*Omega^2*R*Li_l_out2-80.*Cla*r^2*theta_1s*a1_l_out2*R+80.*Cla*Omega*p*a1_l_out2*R+80.*Cla*r^2*theta_1c*b1_l_out2*R+160.*Cla*theta_1c*r*b1_l_out2*R-565.4866776*Cla*twist*Omega*u*a0_l_out2-160.*Cla*p*a1_l_out2*R-480.*Cd*R*Omega*r+80.*Cla*u*twist*p+80.*Cla*theta_1s*r*a1_l_out2*R+320.*Cla*q*b1_l_out2*R+160.*Cla*twist*v*q+160.*Cla*twist*v*b1_l_out2+240.*Cla*twist*r*w+240.*Cla*twist*Omega*w-80.*Cla*u*twist*a1_l_out2+80.*Cla*Omega*b1_l_out2^2*R+80.*Cla*r*b1_l_out2^2*R-80.*Cla*r*a1_l_out2^2*R-80.*Cla*Omega*a1_l_out2^2*R+80.*Cla*r*p*a1_l_out2*R-160.*Cla*theta_1s*Omega*r*a1_l_out2*R+188.4955592*Cla*theta_0l*r*b1_l_out2*R+80.*Cla*r*q*b1_l_out2*R+188.4955592*Cla*theta_0l*Omega*q*R-240.*Cla*twist*r*Omega*R*Li_l_out2-240.*Cla*twist*r*Omega*R*Lc_l-80.*Cla*Omega^2*theta_1s*a1_l_out2*R+188.4955592*Cla*theta_0l*r*q*R)*(R^3-1.*cr^3*R^3)/R-0.2083333334e-2*c*rhoh*(-188.4955592*Cla*R^2*r*Omega*Li_l_out2*b1_l_out2-188.4955592*Cla*R^2*r*Omega*Lc_l*b1_l_out2+47.12388980*Cla*Omega*v*a1_l_out2^2*R-240.*Cla*theta_0l*R^2*r*Omega*Li_l_out2-141.3716694*Cla*v*theta_1s*r*a1_l_out2*R+188.4955592*Cla*Omega*v*a0_l_out2^2*R+141.3716694*Cla*v*theta_1c*r*b1_l_out2*R+240.*Cla*theta_0l*R*r*w-240.*Cla*theta_0l*R^2*r*Omega*Lc_l+240.*Cla*theta_0l*R*Omega*w+47.12388980*Cla*r*v*a1_l_out2^2*R+141.3716694*Cla*v*p*a1_l_out2*R-376.9911184*R^2*Cla*q*Omega*Li_l_out2+47.12388980*Cla*u*theta_1c*p*R-47.12388980*Cla*u*theta_1s*q*R+141.3716694*Cla*Omega*v*b1_l_out2^2*R-47.12388980*Cla*u*theta_1s*b1_l_out2*R-329.8672286*Cla*u*theta_1s*r*b1_l_out2*R+320.*Cla*theta_0l*u*r*a1_l_out2*R+235.6194490*Cla*u*b1_l_out2*p*R-329.8672286*Cla*theta_1s*Omega*u*b1_l_out2*R+240.*Cla*v*theta_1s*r*a0_l_out2*R-400.*Cla*twist*u*v*a0_l_out2-320.*Cla*theta_1c*r*u*a0_l_out2*R+160.*Cla*v*theta_0l*q*R-240.*Cla*theta_0l*R^2*Omega^2*Lc_l+188.4955592*Cla*theta_1c*r*w*R-188.4955592*R^2*Cla*theta_1c*r*Omega*Lc_l+141.3716694*Cla*r*v*b1_l_out2^2*R+240.*Cla*v*theta_0l*Omega*b1_l_out2*R-188.4955592*Cla*R^2*Omega^2*Lc_l*b1_l_out2-188.4955592*R^2*Cla*theta_1c*r*Omega*Li_l_out2-47.12388980*Cla*theta_1s*v*p*R+47.12388980*Cla*theta_1s*v*a1_l_out2*R+240.*Cla*theta_0l*r*v*b1_l_out2*R-47.12388980*Cla*u*theta_1c*a1_l_out2*R-188.4955592*Cla*R^2*Omega^2*Li_l_out2*b1_l_out2+94.24777961*Cla*Omega*u*a1_l_out2*b1_l_out2*R-188.4955592*Cla*twist*v*Omega*Li_l_out2*R-188.4955592*Cla*twist*v*Omega*Lc_l*R-376.9911184*R^2*Cla*q*Omega*Lc_l-80.*Cla*theta_0l*u*a1_l_out2*R-565.4866776*Cla*theta_0l*r*u*a0_l_out2*R+188.4955592*Cla*theta_1c*Omega*w*R+160.*Cla*v*theta_0l*b1_l_out2*R+240.*Cla*v*a0_l_out2*a1_l_out2*R+80.*Cla*theta_0l*u*p*R+282.7433388*Cla*twist*u*v*a1_l_out2-376.9911184*R^2*Cla*b1_l_out2*Omega*Li_l_out2+329.8672286*Cla*q*u*a1_l_out2*R-400.*Cla*u*q*a0_l_out2*R-400.*Cla*u*b1_l_out2*a0_l_out2*R+188.4955592*Cla*Omega*w*b1_l_out2*R+141.3716694*Cla*theta_1c*v*q*R+235.6194490*Cla*theta_1c*r*u*a1_l_out2*R-141.3716694*Cla*v*theta_1s*Omega*a1_l_out2*R+141.3716694*Cla*theta_1c*v*b1_l_out2*R-376.9911184*R^2*Cla*b1_l_out2*Omega*Lc_l-188.4955592*R^2*Cla*theta_1c*Omega^2*Li_l_out2+94.24777961*Cla*b1_l_out2*u*a1_l_out2*R+188.4955592*Cla*r*v*a0_l_out2^2*R+141.3716694*Cla*v*theta_1c*Omega*b1_l_out2*R+240.*Cla*theta_1s*Omega*v*a0_l_out2*R-240.*Cla*v*a0_l_out2*p*R-240.*Cla*theta_0l*R^2*Omega^2*Li_l_out2-160.*Cla*r*u*a0_l_out2*b1_l_out2*R+320.*Cla*theta_0l*u*Omega*a1_l_out2*R+235.6194490*Cla*theta_1c*Omega*u*a1_l_out2*R-141.3716694*Cla*v*a1_l_out2^2*R-160.*Cla*r*v*a0_l_out2*a1_l_out2*R-320.*Cla*theta_1c*Omega*u*a0_l_out2*R+188.4955592*Cla*u^2*twist*b1_l_out2-376.9911184*Cd*v*r*R+376.9911184*Cla*b1_l_out2*w*R+188.4955592*Cla*twist*v*w-376.9911184*Cd*Omega*v*R+141.3716694*Cla*v*b1_l_out2^2*R+94.24777961*Cla*v^2*twist*b1_l_out2+376.9911184*Cla*q*w*R-160.*Cla*Omega*v*a0_l_out2*a1_l_out2*R-160.*Cla*Omega*u*a0_l_out2*b1_l_out2*R-565.4866776*Cla*theta_0l*Omega*u*a0_l_out2*R+141.3716694*Cla*v*q*b1_l_out2*R+188.4955592*Cla*r*w*b1_l_out2*R-188.4955592*R^2*Cla*theta_1c*Omega^2*Lc_l+94.24777961*Cla*r*u*a1_l_out2*b1_l_out2*R)*(R^2-1.*cr^2*R^2)/R-0.4166666667e-2*c*rhoh*(240.*Cla*R*w^2+288.*Cla*u*v*b1_l_out2*a1_l_out2*R+94.24777961*Cla*v^2*theta_1s*a0_l_out2*R-480.*Cla*Omega*R^2*Lc_l*w-480.*Cla*Omega*R^2*Li_l_out2*w+480.*Cla*Omega^2*R^3*Lc_l*Li_l_out2+240.*Cla*Omega^2*R^3*Lc_l^2+240.*Cla*Omega^2*R^3*Li_l_out2^2-80.*Cd*u^2*R-565.4866776*Cla*u*v*a0_l_out2*b1_l_out2*R+160.*Cla*v^2*a0_l_out2^2*R-160.*R^2*Cla*theta_1c*v*Omega*Lc_l+64.*Cla*v^2*a1_l_out2^2*R-188.4955592*R^2*Cla*theta_0l*v*Omega*Lc_l+240.*Cla*u^2*a0_l_out2^2*R+188.4955592*Cla*theta_0l*v*w*R+282.7433388*Cla*theta_0l*v*u*a1_l_out2*R-188.4955592*Cla*v^2*a0_l_out2*a1_l_out2*R-282.7433388*Cla*theta_1c*u*v*a0_l_out2*R+160.*Cla*u^2*a1_l_out2^2*R-376.9911184*Cla*u^2*a1_l_out2*a0_l_out2*R+94.24777961*Cla*v^2*theta_0l*b1_l_out2*R+565.4866776*R^2*Cla*u*a0_l_out2*Omega*Lc_l+224.*Cla*theta_1c*u*v*a1_l_out2*R+96.*Cla*v^2*b1_l_out2^2*R+80.*R^2*Cla*theta_1s*u*Omega*Lc_l-188.4955592*R^2*Cla*theta_0l*v*Omega*Li_l_out2-400.*R^2*Cla*u*Omega*Lc_l*a1_l_out2+80.*Cla*u^2*b1_l_out2^2*R-400.*Cla*v*theta_0l*u*a0_l_out2*R-240.*R^2*Cla*Omega*Li_l_out2*v*b1_l_out2-240.*R^2*Cla*Omega*Lc_l*v*b1_l_out2-80.*Cla*u*theta_1s*w*R+64.*Cla*theta_1c*v^2*b1_l_out2*R-64.*Cla*v^2*theta_1s*a1_l_out2*R-565.4866776*Cla*u*a0_l_out2*w*R+240.*Cla*v*b1_l_out2*w*R-400.*R^2*Cla*u*Omega*Li_l_out2*a1_l_out2+565.4866776*R^2*Cla*u*a0_l_out2*Omega*Li_l_out2-160.*R^2*Cla*theta_1c*v*Omega*Li_l_out2+188.4955592*Cla*u^2*theta_1s*a0_l_out2*R+400.*Cla*u*w*a1_l_out2*R+188.4955592*Cla*u^2*theta_0l*b1_l_out2*R+80.*R^2*Cla*theta_1s*u*Omega*Li_l_out2-160.*Cd*v^2*R+160.*Cla*theta_1c*v*w*R-176.*Cla*u*theta_1s*v*b1_l_out2*R+80.*Cla*theta_1c*u^2*b1_l_out2*R-80.*Cla*theta_1s*u^2*a1_l_out2*R)*(R-1.*cr*R)/R;
Ql_out2=0.4166666666e-2*rhoh*c*(48.*Cla*twist*r*q+48.*Cla*twist*Omega*b1_l_out2+48.*Cla*twist*r*b1_l_out2+48.*Cla*twist*Omega*q)*(R^5-1.*cr^5*R^5)/R+0.5208333332e-2*rhoh*c*(37.69911184*Cla*Omega*theta_1c*b1_l_out2*R+37.69911184*Cla*theta_1s*Omega*a1_l_out2*R+37.69911184*Cla*twist*v*r*b1_l_out2+37.69911184*Cla*q^2*R-75.39822369*Cd*R*r^2-75.39822369*Cd*R*Omega^2+37.69911184*Cla*a1_l_out2^2*R+37.69911184*Cla*b1_l_out2^2*R+37.69911184*Cla*p^2*R+37.69911184*Cla*u*twist*r*a1_l_out2+37.69911184*Cla*theta_1c*r*q*R+37.69911184*Cla*twist*Omega*v*b1_l_out2-37.69911184*Cla*theta_1s*r*p*R+37.69911184*Cla*u*twist*Omega*a1_l_out2+37.69911184*Cla*Omega*theta_1c*q*R-48.*Cla*twist*r*u*a0_l_out2-37.69911184*Cla*theta_1s*Omega*p*R+48.*Cla*theta_0l*Omega*b1_l_out2*R-75.39822369*Cla*twist*Omega^2*R*Lc_l-75.39822369*Cla*twist*Omega^2*R*Li_l_out2+37.69911184*Cla*theta_1c*r*b1_l_out2*R-48.*Cla*twist*Omega*u*a0_l_out2-75.39822369*Cla*p*a1_l_out2*R-150.7964474*Cd*R*Omega*r+37.69911184*Cla*u*twist*p+37.69911184*Cla*theta_1s*r*a1_l_out2*R+75.39822369*Cla*q*b1_l_out2*R+37.69911184*Cla*twist*v*q+37.69911184*Cla*twist*v*b1_l_out2+75.39822369*Cla*twist*r*w+75.39822369*Cla*twist*Omega*w-37.69911184*Cla*u*twist*a1_l_out2+48.*Cla*theta_0l*r*b1_l_out2*R+48.*Cla*theta_0l*Omega*q*R-75.39822369*Cla*twist*r*Omega*R*Li_l_out2-75.39822369*Cla*twist*r*Omega*R*Lc_l+48.*Cla*theta_0l*r*q*R)*(R^4-1.*cr^4*R^4)/R+0.6944444443e-2*rhoh*c*(-75.39822369*Cla*theta_0l*R^2*r*Omega*Li_l_out2-16.*Cla*v*theta_1s*r*a1_l_out2*R+16.*Cla*v*theta_1c*r*b1_l_out2*R+75.39822369*Cla*theta_0l*R*r*w-75.39822369*Cla*theta_0l*R^2*r*Omega*Lc_l+75.39822369*Cla*theta_0l*R*Omega*w+32.*Cla*v*p*a1_l_out2*R-96.*R^2*Cla*q*Omega*Li_l_out2+16.*Cla*u*theta_1c*p*R-16.*Cla*u*theta_1s*q*R-16.*Cla*u*theta_1s*b1_l_out2*R-16.*Cla*u*theta_1s*r*b1_l_out2*R+37.69911184*Cla*theta_0l*u*r*a1_l_out2*R+32.*Cla*u*b1_l_out2*p*R-16.*Cla*theta_1s*Omega*u*b1_l_out2*R+37.69911184*Cla*v*theta_1s*r*a0_l_out2*R-75.39822369*Cla*twist*u*v*a0_l_out2-37.69911184*Cla*theta_1c*r*u*a0_l_out2*R+37.69911184*Cla*v*theta_0l*q*R-75.39822369*Cla*theta_0l*R^2*Omega^2*Lc_l+48.*Cla*theta_1c*r*w*R-48.*R^2*Cla*theta_1c*r*Omega*Lc_l+37.69911184*Cla*v*theta_0l*Omega*b1_l_out2*R-48.*R^2*Cla*theta_1c*r*Omega*Li_l_out2-16.*Cla*theta_1s*v*p*R+16.*Cla*theta_1s*v*a1_l_out2*R+37.69911184*Cla*theta_0l*r*v*b1_l_out2*R-16.*Cla*u*theta_1c*a1_l_out2*R-48.*Cla*twist*v*Omega*Li_l_out2*R-48.*Cla*twist*v*Omega*Lc_l*R-96.*R^2*Cla*q*Omega*Lc_l-37.69911184*Cla*theta_0l*u*a1_l_out2*R-48.*Cla*theta_0l*r*u*a0_l_out2*R+48.*Cla*theta_1c*Omega*w*R+37.69911184*Cla*v*theta_0l*b1_l_out2*R+75.39822369*Cla*v*a0_l_out2*a1_l_out2*R+37.69911184*Cla*theta_0l*u*p*R+48.*Cla*twist*u*v*a1_l_out2-96.*R^2*Cla*b1_l_out2*Omega*Li_l_out2+64.*Cla*q*u*a1_l_out2*R-75.39822369*Cla*u*q*a0_l_out2*R-75.39822369*Cla*u*b1_l_out2*a0_l_out2*R+32.*Cla*theta_1c*v*q*R+32.*Cla*theta_1c*r*u*a1_l_out2*R-16.*Cla*v*theta_1s*Omega*a1_l_out2*R+32.*Cla*theta_1c*v*b1_l_out2*R-96.*R^2*Cla*b1_l_out2*Omega*Lc_l-48.*R^2*Cla*theta_1c*Omega^2*Li_l_out2+32.*Cla*b1_l_out2*u*a1_l_out2*R+16.*Cla*v*theta_1c*Omega*b1_l_out2*R+37.69911184*Cla*theta_1s*Omega*v*a0_l_out2*R-75.39822369*Cla*v*a0_l_out2*p*R-75.39822369*Cla*theta_0l*R^2*Omega^2*Li_l_out2+37.69911184*Cla*theta_0l*u*Omega*a1_l_out2*R+32.*Cla*theta_1c*Omega*u*a1_l_out2*R-32.*Cla*v*a1_l_out2^2*R-37.69911184*Cla*theta_1c*Omega*u*a0_l_out2*R+16.*Cla*u^2*twist*b1_l_out2-96.*Cd*v*r*R+96.*Cla*b1_l_out2*w*R+48.*Cla*twist*v*w-96.*Cd*Omega*v*R+32.*Cla*v*b1_l_out2^2*R+16.*Cla*v^2*twist*b1_l_out2+96.*Cla*q*w*R-48.*Cla*theta_0l*Omega*u*a0_l_out2*R+32.*Cla*v*q*b1_l_out2*R-48.*R^2*Cla*theta_1c*Omega^2*Lc_l)*(R^3-1.*cr^3*R^3)/R+0.1041666666e-1*rhoh*c*(75.39822369*Cla*R*w^2+37.69911184*Cla*u*v*b1_l_out2*a1_l_out2*R+16.*Cla*v^2*theta_1s*a0_l_out2*R-150.7964474*Cla*Omega*R^2*Lc_l*w-150.7964474*Cla*Omega*R^2*Li_l_out2*w+150.7964474*Cla*Omega^2*R^3*Lc_l*Li_l_out2+75.39822369*Cla*Omega^2*R^3*Lc_l^2+75.39822369*Cla*Omega^2*R^3*Li_l_out2^2-37.69911184*Cd*u^2*R-64.*Cla*u*v*a0_l_out2*b1_l_out2*R+37.69911184*Cla*v^2*a0_l_out2^2*R-37.69911184*R^2*Cla*theta_1c*v*Omega*Lc_l+9.424777961*Cla*v^2*a1_l_out2^2*R-48.*R^2*Cla*theta_0l*v*Omega*Lc_l+37.69911184*Cla*u^2*a0_l_out2^2*R+48.*Cla*theta_0l*v*w*R+48.*Cla*theta_0l*v*u*a1_l_out2*R-32.*Cla*v^2*a0_l_out2*a1_l_out2*R-48.*Cla*theta_1c*u*v*a0_l_out2*R+28.27433388*Cla*u^2*a1_l_out2^2*R-64.*Cla*u^2*a1_l_out2*a0_l_out2*R+16.*Cla*v^2*theta_0l*b1_l_out2*R+96.*R^2*Cla*u*a0_l_out2*Omega*Lc_l+37.69911184*Cla*theta_1c*u*v*a1_l_out2*R+28.27433388*Cla*v^2*b1_l_out2^2*R+37.69911184*R^2*Cla*theta_1s*u*Omega*Lc_l-48.*R^2*Cla*theta_0l*v*Omega*Li_l_out2-75.39822369*R^2*Cla*u*Omega*Lc_l*a1_l_out2+9.424777961*Cla*u^2*b1_l_out2^2*R-75.39822369*Cla*v*theta_0l*u*a0_l_out2*R-75.39822369*R^2*Cla*Omega*Li_l_out2*v*b1_l_out2-75.39822369*R^2*Cla*Omega*Lc_l*v*b1_l_out2-37.69911184*Cla*u*theta_1s*w*R+9.424777961*Cla*theta_1c*v^2*b1_l_out2*R-9.424777961*Cla*v^2*theta_1s*a1_l_out2*R-96.*Cla*u*a0_l_out2*w*R+75.39822369*Cla*v*b1_l_out2*w*R-75.39822369*R^2*Cla*u*Omega*Li_l_out2*a1_l_out2+96.*R^2*Cla*u*a0_l_out2*Omega*Li_l_out2-37.69911184*R^2*Cla*theta_1c*v*Omega*Li_l_out2+16.*Cla*u^2*theta_1s*a0_l_out2*R+75.39822369*Cla*u*w*a1_l_out2*R+16.*Cla*u^2*theta_0l*b1_l_out2*R+37.69911184*R^2*Cla*theta_1s*u*Omega*Li_l_out2-37.69911184*Cd*v^2*R+37.69911184*Cla*theta_1c*v*w*R-37.69911184*Cla*u*theta_1s*v*b1_l_out2*R+9.424777961*Cla*theta_1c*u^2*b1_l_out2*R-9.424777961*Cla*theta_1s*u^2*a1_l_out2*R)*(R^2-1.*cr^2*R^2)/R;

% Total rotor forces on section 2 (negative x-direction)
Tneg=Tl_in2+Tl_out2;    % Thrust force
Hneg=Hl_in2+Hl_out2;    % Longitudinal force
Sneg=Sl_in2+Sl_out2;    % Lateral force
Qneg=Ql_in2+Ql_out2;    % Torque

% Determining non-dimensional coefficients lower rotor section 2 inside
% upper rotor wake
CTl_in2=Tl_in2/(dimless);
CHl_in2=Hl_in2/dimless;
CSl_in2=Sl_in2/dimless;
CQl_in2=Ql_in2/(R*dimless);

% Determining thrust coefficients inner part of section 2 (negative x direction) [-]
Ct_el_in2 = CTl_in2;                                                                                % Blade element theory
Ct_gl_in2 = 2*Li_l_in2*sqrt((mu*cos(alpha_cp-a1_l_in2))^2+(mu*sin(alpha_cp-a1_l_in2)+Li_l_in2)^2);  % Glauert theory
   
% Determining non-dimensional coefficients lower rotor section 2 outside
% upper rotor wake
CTl_out2=Tl_out2/(dimless);
CHl_out2=Hl_out2/dimless;
CSl_out2=Sl_out2/dimless;
CQl_out2=Ql_out2/(R*dimless);

% Determining thrust coefficients outer part of section 2 (negative x
% direction) [-]
Ct_el_out2 = CTl_out2;                                                                                  % Blade element theory
Ct_gl_out2 = 2*Li_l_out2*sqrt((mu*cos(alpha_cp-a1_l_out2))^2+(mu*sin(alpha_cp-a1_l_out2)+Li_l_out2)^2); % Glauert theory
  

% Total coefficients on section 2 (negative x direction) of lower rotor [-]
CTl_neg=CTl_in2+CTl_out2;
CHl_neg=CHl_in2+CHl_out2;
CSl_neg=CSl_in2+CSl_out2;
CQl_neg=CQl_in2+CQl_out2;

% Summing lower rotor forces and coefficients
Tl=Tpos+Tneg;   % Total thrust force on lower rotor
Hl=Hpos+Hneg;   % Total longitudinal force on lower rotor
Sl=Spos+Sneg;   % Total lateral force on lower rotor
Ql=Qpos+Qneg;   % Total torque on lower rotor

CTl=CTl_pos+CTl_neg;
CHl=CHl_pos+CHl_neg;
CSl=CSl_pos+CSl_neg;
CQl=CQl_pos+CQl_neg;

% Determining total Glauert thrust coefficient of lower rotor
Li_lgl=(Li_l_in+Li_l_out+Li_l_in2+Li_l_out2)/4;     % Mean value of induced velocities lower rotor

% Flapping coefficient for Glauert theory
a0_l=(gamma/8*(1+mu_x^2-2*r/Omega)*theta_0l-gamma/6*mu_y*theta_1c-gamma/6*mu_x*theta_1s+...
    gamma/8*(4/5-8/5*r/Omega+2/3*mu_x^2)*theta_tw-gamma/6*(-mu_z+Li_lgl)+gamma/12*mu_x*p/Omega+...
    gamma/12*mu_y*q/Omega)/(vb^2-2*r/Omega);
a1_l=(gamma/6*mu_y*a0_l+gamma/3*mu_x*theta_0l-gamma/8*mu_x*mu_y*theta_1c-...
    gamma/8*(1-2*r/Omega+3/2*mu_x^2)*theta_1s+gamma/4*mu_x*theta_tw-gamma/4*mu_x*(-mu_z+Li_lgl)+...
    gamma/8*p/Omega-2*q/Omega)/(1-r/Omega-mu_x^2/2+mu_y^2/2);
b1_l=(-gamma/6*mu_x*a0_l+gamma/3*mu_y*theta_0l-gamma/8*(1-2*r/Omega+mu_x^2/2)*...
    theta_1c-gamma/8*mu_x*mu_y*theta_1s+gamma/4*mu_y*theta_tw-gamma/8*mu_y*(-mu_z+Li_lgl)+2*p/Omega+...
    gamma/8*q/Omega)/(-1+r/Omega-mu_x^2/2+mu_y^2/2);
ba_l=sqrt(a1_l^2+b1_l^2);

% Thrust coefficient according to Glauert
Ct_gl_lo = 2*Li_lgl*sqrt((mu*cos(alpha_cp-a1_l))^2+(mu*sin(alpha_cp-a1_l)+Li_lgl)^2);


% Summing rotor forces and moments
Xl=Tl*sin(theta_1s)-Hl*cos(theta_1s);
Yl=Tl*sin(theta_1c)-Sl*cos(theta_1c);
Zl=-Tl*cos(theta_1s)*cos(theta_1c)-Hl*sin(theta_1s)+Sl*sin(theta_1c);

Ll = Yl*zhl-Zl*yhl;
Ml = -Xl*zhl-Zl*xhl;
Nl = Ql;

%------------Determining other helicopter forces--------------------------%

% Fuselage
alpha_fus = atan2(w,u);                             % AOA fuselage [rad]
R_fus     = 0.5*rhoh*V^2*CDS;                       % Drag fuselage [N]

X_fus = -R_fus*cos(alpha_fus);                      % X-force
Z_fus = -R_fus*sin(alpha_fus);                      % Z-force
M_fus = rhoh*V^2*K_fus*Vol_fus*alpha_fus;           % Pitch moment

% Horizontal stabilizer
alpha_hs = alpha0_hs+atan2((w+q*x_hs),u);           % AOA HS [rad]
V_hs	 = sqrt(u^2+(w+q*x_hs)^2);                  % HS velocity  [m/s]

Z_hs = -1/2*rhoh*V_hs^2*0.65*S_hs*Cla_hs*alpha_hs;  % Z-force
M_hs = Z_hs*x_hs;                                   % Pitch moment    

% Vertical fin
beta_fin = beta0_fin+atan2(v-r*x_fin+p*z_fin,u);    % Sideslip angle VF [rad]
V_fin	 = sqrt(u^2+(v-r*x_fin+p*z_fin)^2);         % VF velocity  [m/s]

Y_fin = -1/2*rhoh*V_fin^2*S_fin*Cla_fin*beta_fin;   % Y-force
L_fin = z_fin*Y_fin;                                % Roll moment
N_fin = -x_fin*Y_fin;                               % Yaw moment


%---------------Formulation of equations of motion-----------------------%

% Summation of all forces (except weight components)
X = Xu+Xl+X_fus;
Y = Yu+Yl+Y_fin;
Z = Zu+Zl+Z_fus+Z_hs;

% Forces in body-axes
Fx = -W*sin(theta)+X;
Fy = W*cos(theta)*sin(phi)+Y;
Fz = W*cos(theta)*cos(phi)+Z;
W1=W*cos(theta)*cos(phi);

% Summation of all moments
L = Lu+Ll+L_fin;
M = Mu+Ml+M_hs;
N = Nu+Nl;

% Accelerations in body-axes
udot = Fx/m-q*w+r*v;
vdot = Fy/m-r*u+p*w;
wdot = Fz/m-p*v+q*u;

pdot = ((Iyy*Izz-Izz^2-Jxz^2)*r*q+(Ixx-Iyy+Izz)*Jxz*p*q+Izz*L+Jxz*N)/...
        (Ixx*Izz-Jxz^2);
qdot = (M+(Izz-Ixx)*p*r-Jxz*(r^2-p^2))/Iyy;
rdot = ((Ixx^2-Ixx*Iyy+Jxz^2)*p*q-(Ixx-Iyy+Izz)*Jxz*q*r+Jxz*L+Ixx*N)/...
        (Ixx*Izz-Jxz^2);

psidot	 = (q*sin(phi)+r*cos(phi))/cos(theta);
thetadot = q*cos(phi)-r*sin(phi);
phidot	 = p+psidot*sin(theta);

% Velocities in Earth-axes
xdot = (u*cos(theta)+(v*sin(phi)+w*cos(phi))*sin(theta))*cos(psi)-...
       (v*cos(phi)-w*sin(phi))*sin(psi);
ydot = (u*cos(theta)+(v*sin(phi)+w*cos(phi))*sin(theta))*sin(psi)+...
       (v*cos(phi)-w*sin(phi))*cos(psi);
zdot = -u*sin(theta)+(v*sin(phi)+w*cos(phi))*cos(theta);

L0_updot = (CTu-Ct_gl_up)/tau_lambda;
L0_lodot = (CTl-Ct_gl_lo)/tau_lambda;

% Output
f = [udot vdot wdot pdot qdot rdot psidot thetadot phidot xdot ydot zdot...
     L0_updot L0_lodot]';